<!DOCTYPE html>
<!-- saved from url=(0058)https://www.bezkoder.com/node-js-jwt-authentication-mysql/ -->
<html class="no-js" lang="en-US"><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><link href="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/css" rel="stylesheet">

<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="theme-color" content="">
<meta name="author" content="bezkoder">
<link rel="profile" href="https://gmpg.org/xfn/11">
<meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">

<title>Node.js Express: JWT example | Token Based Authentication &amp; Authorization - BezKoder</title><link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin=""><link rel="preconnect" href="https://fonts.googleapis.com/"><style type="text/css">@font-face {
  font-family: 'Open Sans';
  font-style: italic;
  font-weight: 400;
  font-stretch: normal;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/opensans/v36/memQYaGs126MiZpBA-UFUIcVXSCEkx2cmqvXlWq8tWZ0Pw86hd0Rk8ZkWVAexQ.ttf) format('truetype');
}
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 400;
  font-stretch: normal;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/opensans/v36/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B4gaVc.ttf) format('truetype');
}
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 600;
  font-stretch: normal;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/opensans/v36/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsgH1x4gaVc.ttf) format('truetype');
}
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 700;
  font-stretch: normal;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/opensans/v36/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsg-1x4gaVc.ttf) format('truetype');
}
@font-face {
  font-family: 'Roboto Slab';
  font-style: normal;
  font-weight: 300;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/robotoslab/v34/BngbUXZYTXPIvIBgJJSb6s3BzlRRfKOFbvjo0oSmb2Rm.ttf) format('truetype');
}
@font-face {
  font-family: 'Roboto Slab';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/robotoslab/v34/BngbUXZYTXPIvIBgJJSb6s3BzlRRfKOFbvjojISmb2Rm.ttf) format('truetype');
}
@font-face {
  font-family: 'Roboto Slab';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/robotoslab/v34/BngbUXZYTXPIvIBgJJSb6s3BzlRRfKOFbvjoa4Omb2Rm.ttf) format('truetype');
}
</style><link rel="preload" as="font" href="https://cdnjs.cloudflare.com/ajax/libs/line-awesome/1.3.0/font-awesome-line-awesome/webfonts/fa-regular-400.woff2" crossorigin=""><link rel="preload" as="font" href="https://cdnjs.cloudflare.com/ajax/libs/line-awesome/1.3.0/font-awesome-line-awesome/webfonts/fa-brands-400.woff2" crossorigin=""><link rel="preload" as="font" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/fonts/glyphicons-halflings-regular.woff2" crossorigin=""><link rel="preload" as="font" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/webfonts/fa-solid-900.woff2" crossorigin=""><link rel="stylesheet" id="siteground-optimizer-combined-css-1b3572d7bb27ce7ea30b179f97acf106" href="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/siteground-optimizer-combined-css-1b3572d7bb27ce7ea30b179f97acf106.css" media="all"> <link rel="preload" href="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/siteground-optimizer-combined-css-1b3572d7bb27ce7ea30b179f97acf106.css" as="style">
<link rel="canonical" href="https://www.bezkoder.com/node-js-jwt-authentication-mysql/">
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Node.js Express: JWT example | Token Based Authentication &amp; Authorization - BezKoder">
<meta property="og:description" content="In this tutorial, we’re gonna build a Node.js Express Rest API example that supports Token Based Authentication with JWT (JSONWebToken). You’ll know: Appropriate Flow for User Signup &amp; User Login with JWT Authentication Node.js Express Architecture with CORS, Authentication &amp; Authorization middlewares &amp; Sequelize How to configure Express routes to work with JWT How to […]">
<meta property="og:url" content="https://www.bezkoder.com/node-js-jwt-authentication-mysql/">
<meta property="og:site_name" content="BezKoder">
<meta property="article:publisher" content="https://www.facebook.com/bezkoder">
<meta property="article:published_time" content="2019-11-14T15:09:13+00:00">
<meta property="article:modified_time" content="2023-10-16T04:07:51+00:00">
<meta property="og:image" content="https://www.bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-feature-image.png">
<meta property="og:image:width" content="750">
<meta property="og:image:height" content="410">
<meta property="og:image:type" content="image/png">
<meta name="author" content="bezkoder">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:label1" content="Written by">
<meta name="twitter:data1" content="bezkoder">
<meta name="twitter:label2" content="Est. reading time">
<meta name="twitter:data2" content="17 minutes">
<script type="text/javascript" async="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/analytics.js.download" nonce="rXtwkqx90Oe6rsBXI5NpxA"></script><script type="text/javascript" async="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/js" nonce="rXtwkqx90Oe6rsBXI5NpxA"></script><script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebPage","@id":"https://www.bezkoder.com/node-js-jwt-authentication-mysql/","url":"https://www.bezkoder.com/node-js-jwt-authentication-mysql/","name":"Node.js Express: JWT example | Token Based Authentication & Authorization - BezKoder","isPartOf":{"@id":"https://www.bezkoder.com/#website"},"primaryImageOfPage":{"@id":"https://www.bezkoder.com/node-js-jwt-authentication-mysql/#primaryimage"},"image":{"@id":"https://www.bezkoder.com/node-js-jwt-authentication-mysql/#primaryimage"},"thumbnailUrl":"https://www.bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-feature-image.png","datePublished":"2019-11-14T15:09:13+00:00","dateModified":"2023-10-16T04:07:51+00:00","author":{"@id":"https://www.bezkoder.com/#/schema/person/eb4ad162bbd76adb4fde3089aa839a5a"},"breadcrumb":{"@id":"https://www.bezkoder.com/node-js-jwt-authentication-mysql/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://www.bezkoder.com/node-js-jwt-authentication-mysql/"]}]},{"@type":"ImageObject","inLanguage":"en-US","@id":"https://www.bezkoder.com/node-js-jwt-authentication-mysql/#primaryimage","url":"https://www.bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-feature-image.png","contentUrl":"https://www.bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-feature-image.png","width":750,"height":410,"caption":"node-js-jwt-authentication-mysql-feature-image"},{"@type":"BreadcrumbList","@id":"https://www.bezkoder.com/node-js-jwt-authentication-mysql/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://www.bezkoder.com/"},{"@type":"ListItem","position":2,"name":"Node.js Express: JWT example | Token Based Authentication &#038; Authorization"}]},{"@type":"WebSite","@id":"https://www.bezkoder.com/#website","url":"https://www.bezkoder.com/","name":"BezKoder","description":"Mobile &amp; Web App Development Tutorials","potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://www.bezkoder.com/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"Person","@id":"https://www.bezkoder.com/#/schema/person/eb4ad162bbd76adb4fde3089aa839a5a","name":"bezkoder","image":{"@type":"ImageObject","inLanguage":"en-US","@id":"https://www.bezkoder.com/#/schema/person/image/","url":"https://secure.gravatar.com/avatar/40150b9299e69015bc46c30598a81888?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/40150b9299e69015bc46c30598a81888?s=96&d=mm&r=g","caption":"bezkoder"},"url":"https://www.bezkoder.com/author/bezkoder/"}]}</script>

<link rel="dns-prefetch" href="https://fonts.googleapis.com/">
<link rel="alternate" type="application/rss+xml" title="BezKoder » Feed" href="https://www.bezkoder.com/feed/">
<link rel="alternate" type="application/rss+xml" title="BezKoder » Comments Feed" href="https://www.bezkoder.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="BezKoder » Node.js Express: JWT example | Token Based Authentication &amp; Authorization Comments Feed" href="https://www.bezkoder.com/node-js-jwt-authentication-mysql/feed/">
<style id="classic-theme-styles-inline-css" type="text/css">
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id="global-styles-inline-css" type="text/css">
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flow > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-flow > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-flow > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-constrained > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-constrained > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width: var(--wp--style--global--content-size);margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignwide{max-width: var(--wp--style--global--wide-size);}body .is-layout-flex{display: flex;}body .is-layout-flex{flex-wrap: wrap;align-items: center;}body .is-layout-flex > *{margin: 0;}body .is-layout-grid{display: grid;}body .is-layout-grid > *{margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
.wp-block-navigation a:where(:not(.wp-element-button)){color: inherit;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
.wp-block-pullquote{font-size: 1.5em;line-height: 1.6;}
</style>
<style id="quads-styles-inline-css" type="text/css">

    .quads-location ins.adsbygoogle {
        background: transparent !important;
    }
    .quads.quads_ad_container { display: grid; grid-template-columns: auto; grid-gap: 10px; padding: 10px; }
    .grid_image{animation: fadeIn 0.5s;-webkit-animation: fadeIn 0.5s;-moz-animation: fadeIn 0.5s;
        -o-animation: fadeIn 0.5s;-ms-animation: fadeIn 0.5s;}
    .quads-ad-label { font-size: 12px; text-align: center; color: #333;}
    .quads_click_impression { display: none;}
</style>
<script type="text/javascript" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/jquery.min.js.download" id="jquery-core-js"></script>
<link rel="https://api.w.org/" href="https://www.bezkoder.com/wp-json/"><link rel="alternate" type="application/json" href="https://www.bezkoder.com/wp-json/wp/v2/posts/2033"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.bezkoder.com/xmlrpc.php?rsd">
<meta name="generator" content="WordPress 6.4.3">
<link rel="shortlink" href="https://www.bezkoder.com/?p=2033">
<link rel="alternate" type="application/json+oembed" href="https://www.bezkoder.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.bezkoder.com%2Fnode-js-jwt-authentication-mysql%2F">
<link rel="alternate" type="text/xml+oembed" href="https://www.bezkoder.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.bezkoder.com%2Fnode-js-jwt-authentication-mysql%2F&amp;format=xml">
<script async="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/pub-9222145312954144" nonce="rXtwkqx90Oe6rsBXI5NpxA" type="text/javascript"></script><style type="text/css">a:hover, a:active, #secondary .widget .post-content a:hover,
        .woocommerce nav.woocommerce-pagination ul li a:focus, .woocommerce nav.woocommerce-pagination ul li a:hover,
        .woocommerce nav.woocommerce-pagination ul li span.current, #secondary .widget a:hover  {color: #727272;}.social-icons li a {background-color: #8c8c8c !important ;}#footer-area .social-icons li a {background-color: #6d6d6d !important ;}.entry-content {font-family: Open Sans;}</style> <style type="text/css">
				.navbar > .container .navbar-brand {
			color: #dadada;
		}
		</style>
<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #ffffff; }
</style>
<link rel="icon" href="https://www.bezkoder.com/wp-content/uploads/logo-60x60.png" sizes="32x32">
<link rel="icon" href="https://www.bezkoder.com/wp-content/uploads/logo.png" sizes="192x192">
<link rel="apple-touch-icon" href="https://www.bezkoder.com/wp-content/uploads/logo.png">
<meta name="msapplication-TileImage" content="https://www.bezkoder.com/wp-content/uploads/logo.png">
<style type="text/css" id="wp-custom-css">
			/*
#logo {
	margin-top: -15px;
}
*/

.navbar-default .navbar-nav>li>a {
	font-size: 14px !important;
}

.navbar-nav>li {
	padding-left: 8px;
	padding-right: 8px;
}

code {
	color: #555;
	background-color: #f3f3f3 !important;
}

.h1, .h2, h1, h2 {
	line-height: 1.3 !important;
}

pre {
	margin-bottom: 20px !important;
}

code[class*="language-"], pre[class*="language-"] {
	background-color: #fafafa !important;
	border-radius: 0px !important;
	border: 0 !important;
}

.post-inner-content img {
	margin-bottom: 15px;
}

#toc_container {
	border: 0 !important;
	padding: 15px !important;
}

.table-responsive {
	width: 100%;
}

/* left side ad */
.container {
	padding-right: 0;
	max-width: 1000px;
}

.main-content-inner {
	max-width: 630px;
}

.post-inner-content {
	max-width: 630px;
}

.widget-area {
	max-width: 320px;
}

@media screen and (min-width: 868px) {
	.main-content-inner {	
		padding-right: 0px;
		padding-left: 0px;
	}

	.post-inner-content {
		padding-top: 20px;
		padding-right: 0px;
		padding-left: 0px;
	}
}
	
#secondary {
	padding-right: 0px;
	padding-left: 0px;
}

.well {
	padding-left: 20px;
	padding-right: 0px;
}

@media screen and (max-width: 768px) {
  .my-side-ad {
    display: none;
  }
}

@media screen and (max-width:1260px) and (min-width:990px) {
  .my-side-ad {
    display: none;
  }
}

@media screen and (min-width:800px) and (max-width:950px) {
	.site-navigation-inner {
		padding-left: 60px;
	}
	.container {
		max-width: 680px;
	}
}

@media screen and (min-width:768px) and (max-width:800px) {
	.site-navigation-inner {
		padding-left: 160px;
	}
	.post-inner-content, .comments-area, .post-navigation {
		margin-left:80px;
	}
	.main-content-area {
		margin-left: 50px;
	}
}

@media screen and (max-width:990px) and (min-width:800px) {
	.site-navigation-inner {
		padding-left: 100px;
	}
	.post-inner-content {
		margin-left:50px;
	}
}

@media screen and (max-width:868px) and (min-width:800px) {
	.main-content-area {
		margin-left: 100px;
	}
}

@media screen and (max-width:990px) and (min-width:868px) {
	.main-content-area {
		margin-left: 150px;
	}
}

@media screen and (max-width:980px) and (min-width:800px) {
	#secondary {
		margin-left: 60px;
	}
}

@media screen and (max-width:800px) and (min-width:768px) {
	#secondary {
		margin-left: 120px;
	}
}

.comments-area, .post-navigation {
	padding-left: 10px;
}

#menu-footer-links {
	padding-left: 45px;
}

.my-side-ad {
  width: 120px;
  height: 600px;
  min-height: 100px;
  position: fixed;
  top: 70px;
  left: 0%;
  background-color: #fff;
}

#close-side-ad-btn {
  position: absolute;
  left: 0;
  top: -25px;
	width: 25px;
	height: 25px;
	padding: 3px;
	background-color: green;
	font-size: 10px;
	font-weight: bold;
}		</style>

<script async="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/js(1)" type="text/javascript"></script>
<script type="text/javascript">
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-141701321-1');
</script>
<script async="" data-ad-client="ca-pub-9222145312954144" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/f.txt" type="text/javascript"></script>
<script async="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/AGSKWxVDtj6qx7NheiS2uZoKMu2w93vzbOPzGkIxAMCRC9m-dcT7gazCRPQrGsvfjh6OFSc4i5XeuzWA449pvTyATFgYK94yjKZmEYwBm-26OQNaKkvGpYdSCua" nonce="rXtwkqx90Oe6rsBXI5NpxA"></script><script async="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/AGSKWxU9Lj6EWknMoNdGPF7qZTHEWr3lWdarcWC8tAgCiqCzRWZu-g8S0owfo-X_jQoLEv4FH-RlIIOAX2IlNzj29aKrpuTBtNC8phdVKA829s3fTDh_TnpdkY2" nonce="rXtwkqx90Oe6rsBXI5NpxA"></script><style>div.fc-ab-root, .fc-ab-root a:link, .fc-ab-root div,.fc-ab-root h1,.fc-ab-root h2,.fc-ab-root a,.fc-ab-root p,.fc-ab-root button,.fc-ab-root i,.fc-ab-root input,.fc-ab-root label,.fc-ab-root span,.fc-ab-root ul,.fc-ab-root li,.fc-ab-root hr,.fc-ab-root img,.fc-ab-root br,.fc-ab-root footer{-webkit-app-region: none; -webkit-appearance: none; -webkit-border-horizontal-spacing: 0; -webkit-border-image: none; -webkit-border-vertical-spacing: 0; -webkit-box-align: stretch; -webkit-box-decoration-break: slice; -webkit-box-direction: normal; -webkit-box-flex: 0; -webkit-box-ordinal-group: 1; -webkit-box-orient: horizontal; -webkit-box-pack: start; -webkit-box-reflect: none; -webkit-font-smoothing: auto; -webkit-highlight: none; -webkit-hyphenate-character: auto; -webkit-line-break: auto; -webkit-line-clamp: none; -webkit-locale: auto; -webkit-margin-after-collapse: collapse; -webkit-margin-before-collapse: collapse; -webkit-mask-box-image-outset: 0; -webkit-mask-box-image-repeat: stretch; -webkit-mask-box-image-slice: 0 fill; -webkit-mask-box-image-source: none; -webkit-mask-box-image-width: auto; -webkit-mask-box-image: none; -webkit-mask-clip: border-box; -webkit-mask-composite: source-over; -webkit-mask-image: none; -webkit-mask-origin: border-box; -webkit-mask-position: 0% 0%; -webkit-mask-repeat: repeat; -webkit-mask-size: auto; -webkit-print-color-adjust: economy; -webkit-rtl-ordering: logical; -webkit-tap-highlight-color: rgba(0, 0, 0, 0.4); -webkit-text-combine: none; -webkit-text-decorations-in-effect: none; -webkit-text-emphasis-color: rgb(0, 0, 0); -webkit-text-emphasis-position: over right; -webkit-text-emphasis-style: none; -webkit-text-orientation: vertical-right; -webkit-text-security: none; -webkit-text-stroke-color: rgb(0, 0, 0); -webkit-text-stroke-width: 0; -webkit-user-drag: auto; -webkit-writing-mode: horizontal-tb; align-content: normal; align-items: normal; align-self: auto; alignment-baseline: auto; animation-delay: 0s; animation-direction: normal; animation-duration: 0s; animation-fill-mode: none; animation-iteration-count: 1; animation-name: none; animation-play-state: running; animation-timing-function: ease; backdrop-filter: none; backface-visibility: visible; background-attachment: scroll; background-blend-mode: normal; background-clip: border-box; background-color: rgba(0, 0, 0, 0); background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: repeat; background-size: auto; baseline-shift: 0; border-bottom-color: rgb(0, 0, 0); border-bottom-left-radius: 0; border-bottom-right-radius: 0; border-bottom-style: none; border-bottom-width: 0; border-collapse: separate; border-image-outset: 0; border-image-repeat: stretch; border-image-slice: 100%; border-image-source: none; border-image-width: 1; border-left-color: rgb(0, 0, 0); border-left-style: none; border-left-width: 0; border-right-color: rgb(0, 0, 0); border-right-style: none; border-right-width: 0; border-top-color: rgb(0, 0, 0); border-top-left-radius: 0; border-top-right-radius: 0; border-top-style: none; border-top-width: 0; bottom: auto; box-shadow: none; box-sizing: content-box; break-after: auto; break-before: auto; break-inside: auto; buffered-rendering: auto; caption-side: top; caret-color: rgb(0, 0, 0); clear: none; clip-path: none; clip-rule: nonzero; clip: auto; color-interpolation-filters: linearrgb; color-interpolation: srgb; color-rendering: auto; color: rgb(0, 0, 0); column-count: auto; column-gap: normal; column-rule-color: rgb(0, 0, 0); column-rule-style: none; column-rule-width: 0; column-span: none; column-width: auto; content: normal; cursor: auto; cx: 0; cy: 0; d: none; display: inline; dominant-baseline: auto; empty-cells: show; fill-opacity: 1; fill-rule: nonzero; fill: rgb(0; 0; 0); filter: none; flex-basis: auto; flex-direction: row; flex-grow: 0; flex-shrink: 1; flex-wrap: nowrap; float: none; flood-color: rgb(0, 0, 0); flood-opacity: 1; font-kerning: auto; font-optical-sizing: auto; font-size: 16px; font-stretch: 100%; font-style: normal; font-variant-caps: normal; font-variant-east-asian: normal; font-variant-ligatures: normal; font-variant-numeric: normal; font-variant: normal; font-weight: 400; grid-auto-columns: auto; grid-auto-flow: row; grid-auto-rows: auto; grid-column-end: auto; grid-column-start: auto; grid-row-end: auto; grid-row-start: auto; grid-template-areas: none; grid-template-columns: none; grid-template-rows: none; height: auto; hyphens: manual; image-rendering: auto; isolation: auto; justify-content: normal; justify-items: normal; justify-self: auto; left: auto; letter-spacing: normal; lighting-color: rgb(255, 255, 255); line-break: auto; line-height: normal; list-style-image: none; list-style-position: outside; list-style-type: disc; margin-bottom: 0; margin-left: 0; margin-right: 0; margin-top: 0; marker-end: none; marker-mid: none; marker-start: none; mask-type: luminance; mask: none; max-height: none; max-width: none; min-height: 0; min-width: 0; mix-blend-mode: normal; object-fit: fill; object-position: 50% 50%; offset-distance: 0; offset-path: none; offset-rotate: auto 0deg; opacity: 1; order: 0; orphans: 2; outline-color: rgb(0, 0, 0); outline-offset: 0; outline-style: none; outline-width: 0; overflow-anchor: auto; overflow-wrap: normal; overflow-x: visible; overflow-y: visible; padding-bottom: 0; padding-left: 0; padding-right: 0; padding-top: 0; paint-order: normal; perspective-origin: 0 0; perspective: none; pointer-events: auto; position: static; r: 0; resize: none; right: auto; row-gap: normal; rx: auto; ry: auto; scroll-behavior: auto; shape-image-threshold: 0; shape-margin: 0; shape-outside: none; shape-rendering: auto; speak: normal; stop-color: rgb(0, 0, 0); stop-opacity: 1; stroke-dasharray: none; stroke-dashoffset: 0; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 4; stroke-opacity: 1; stroke-width: 1px; stroke: none; tab-size: 8; table-layout: auto; text-align-last: auto; text-align: start; text-anchor: start; text-decoration-color: rgb(0, 0, 0); text-decoration-line: none; text-decoration-skip-ink: auto; text-decoration-style: solid; text-decoration: none solid rgb(0, 0, 0); text-indent: 0; text-overflow: clip; text-rendering: auto; text-shadow: none; text-size-adjust: auto; text-transform: none; text-underline-position: auto; top: auto; touch-action: auto; transform-origin: 0 0; transform-style: flat; transform: none; transition-delay: 0s; transition-duration: 0s; transition-property: all; transition-timing-function: ease; unicode-bidi: normal; user-select: auto; vector-effect: none; vertical-align: baseline; visibility: visible; white-space: normal; widows: 2; width: auto; will-change: auto; word-break: normal; word-spacing: 0; writing-mode: horizontal-tb; x: 0; y: 0; z-index: auto; zoom: 1;}div.fc-whitelist-root,.fc-whitelist-root div,.fc-whitelist-root iframe{-webkit-app-region: none; -webkit-appearance: none; -webkit-border-horizontal-spacing: 0; -webkit-border-image: none; -webkit-border-vertical-spacing: 0; -webkit-box-align: stretch; -webkit-box-decoration-break: slice; -webkit-box-direction: normal; -webkit-box-flex: 0; -webkit-box-ordinal-group: 1; -webkit-box-orient: horizontal; -webkit-box-pack: start; -webkit-box-reflect: none; -webkit-font-smoothing: auto; -webkit-highlight: none; -webkit-hyphenate-character: auto; -webkit-line-break: auto; -webkit-line-clamp: none; -webkit-locale: auto; -webkit-margin-after-collapse: collapse; -webkit-margin-before-collapse: collapse; -webkit-mask-box-image-outset: 0; -webkit-mask-box-image-repeat: stretch; -webkit-mask-box-image-slice: 0 fill; -webkit-mask-box-image-source: none; -webkit-mask-box-image-width: auto; -webkit-mask-box-image: none; -webkit-mask-clip: border-box; -webkit-mask-composite: source-over; -webkit-mask-image: none; -webkit-mask-origin: border-box; -webkit-mask-position: 0% 0%; -webkit-mask-repeat: repeat; -webkit-mask-size: auto; -webkit-print-color-adjust: economy; -webkit-rtl-ordering: logical; -webkit-tap-highlight-color: rgba(0, 0, 0, 0.4); -webkit-text-combine: none; -webkit-text-decorations-in-effect: none; -webkit-text-emphasis-color: rgb(0, 0, 0); -webkit-text-emphasis-position: over right; -webkit-text-emphasis-style: none; -webkit-text-orientation: vertical-right; -webkit-text-security: none; -webkit-text-stroke-color: rgb(0, 0, 0); -webkit-text-stroke-width: 0; -webkit-user-drag: auto; -webkit-writing-mode: horizontal-tb; align-content: normal; align-items: normal; align-self: auto; alignment-baseline: auto; animation-delay: 0s; animation-direction: normal; animation-duration: 0s; animation-fill-mode: none; animation-iteration-count: 1; animation-name: none; animation-play-state: running; animation-timing-function: ease; backdrop-filter: none; backface-visibility: visible; background-attachment: scroll; background-blend-mode: normal; background-clip: border-box; background-color: rgba(0, 0, 0, 0); background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: repeat; background-size: auto; baseline-shift: 0; border-bottom-color: rgb(0, 0, 0); border-bottom-left-radius: 0; border-bottom-right-radius: 0; border-bottom-style: none; border-bottom-width: 0; border-collapse: separate; border-image-outset: 0; border-image-repeat: stretch; border-image-slice: 100%; border-image-source: none; border-image-width: 1; border-left-color: rgb(0, 0, 0); border-left-style: none; border-left-width: 0; border-right-color: rgb(0, 0, 0); border-right-style: none; border-right-width: 0; border-top-color: rgb(0, 0, 0); border-top-left-radius: 0; border-top-right-radius: 0; border-top-style: none; border-top-width: 0; bottom: auto; box-shadow: none; box-sizing: content-box; break-after: auto; break-before: auto; break-inside: auto; buffered-rendering: auto; caption-side: top; caret-color: rgb(0, 0, 0); clear: none; clip-path: none; clip-rule: nonzero; clip: auto; color-interpolation-filters: linearrgb; color-interpolation: srgb; color-rendering: auto; color: rgb(0, 0, 0); column-count: auto; column-gap: normal; column-rule-color: rgb(0, 0, 0); column-rule-style: none; column-rule-width: 0; column-span: none; column-width: auto; content: normal; cursor: auto; cx: 0; cy: 0; d: none; display: inline; dominant-baseline: auto; empty-cells: show; fill-opacity: 1; fill-rule: nonzero; fill: rgb(0; 0; 0); filter: none; flex-basis: auto; flex-direction: row; flex-grow: 0; flex-shrink: 1; flex-wrap: nowrap; float: none; flood-color: rgb(0, 0, 0); flood-opacity: 1; font-kerning: auto; font-optical-sizing: auto; font-size: 16px; font-stretch: 100%; font-style: normal; font-variant-caps: normal; font-variant-east-asian: normal; font-variant-ligatures: normal; font-variant-numeric: normal; font-variant: normal; font-weight: 400; grid-auto-columns: auto; grid-auto-flow: row; grid-auto-rows: auto; grid-column-end: auto; grid-column-start: auto; grid-row-end: auto; grid-row-start: auto; grid-template-areas: none; grid-template-columns: none; grid-template-rows: none; height: auto; hyphens: manual; image-rendering: auto; isolation: auto; justify-content: normal; justify-items: normal; justify-self: auto; left: auto; letter-spacing: normal; lighting-color: rgb(255, 255, 255); line-break: auto; line-height: normal; list-style-image: none; list-style-position: outside; list-style-type: disc; margin-bottom: 0; margin-left: 0; margin-right: 0; margin-top: 0; marker-end: none; marker-mid: none; marker-start: none; mask-type: luminance; mask: none; max-height: none; max-width: none; min-height: 0; min-width: 0; mix-blend-mode: normal; object-fit: fill; object-position: 50% 50%; offset-distance: 0; offset-path: none; offset-rotate: auto 0deg; opacity: 1; order: 0; orphans: 2; outline-color: rgb(0, 0, 0); outline-offset: 0; outline-style: none; outline-width: 0; overflow-anchor: auto; overflow-wrap: normal; overflow-x: visible; overflow-y: visible; padding-bottom: 0; padding-left: 0; padding-right: 0; padding-top: 0; paint-order: normal; perspective-origin: 0 0; perspective: none; pointer-events: auto; position: static; r: 0; resize: none; right: auto; row-gap: normal; rx: auto; ry: auto; scroll-behavior: auto; shape-image-threshold: 0; shape-margin: 0; shape-outside: none; shape-rendering: auto; speak: normal; stop-color: rgb(0, 0, 0); stop-opacity: 1; stroke-dasharray: none; stroke-dashoffset: 0; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 4; stroke-opacity: 1; stroke-width: 1px; stroke: none; tab-size: 8; table-layout: auto; text-align-last: auto; text-align: start; text-anchor: start; text-decoration-color: rgb(0, 0, 0); text-decoration-line: none; text-decoration-skip-ink: auto; text-decoration-style: solid; text-decoration: none solid rgb(0, 0, 0); text-indent: 0; text-overflow: clip; text-rendering: auto; text-shadow: none; text-size-adjust: auto; text-transform: none; text-underline-position: auto; top: auto; touch-action: auto; transform-origin: 0 0; transform-style: flat; transform: none; transition-delay: 0s; transition-duration: 0s; transition-property: all; transition-timing-function: ease; unicode-bidi: normal; user-select: auto; vector-effect: none; vertical-align: baseline; visibility: visible; white-space: normal; widows: 2; width: auto; will-change: auto; word-break: normal; word-spacing: 0; writing-mode: horizontal-tb; x: 0; y: 0; z-index: auto; zoom: 1;}.fc-ab-root a, .fc-ab-root a p {cursor: pointer;}.fc-ab-root button, .fc-ab-root button div, .fc-ab-root button p, .fc-ab-root .fc-button, .fc-ab-root .fc-button div, .fc-ab-root .fc-button p {cursor: pointer;}.fc-ab-root a:hover {filter: brightness(80%);}.fc-ab-root button:focus p:not(.fc-button-text), .fc-ab-root .fc-button:focus .fc-button-label {outline: auto;}.fc-ab-root button:focus:not(:focus-visible) p .fc-ab-root .fc-button:focus:not(:focus-visible) .fc-button-label {outline: none;}.fc-ab-root .fc-button, .fc-ab-root .fc-dialog {outline: 1px solid transparent;}div.fc-ab-root {display: flex; height: 100%; justify-content: center; width: 100%;}div.fc-whitelist-root {position: fixed; z-index: 2147483644;align-items: center; float: top; height: 100%; left: 0; overflow-x: auto; top: 0;align-items: center; display: flex; justify-content: center; width: 100%;}.fc-ab-root  .fc-close-background {background-color: #fff; cursor: pointer; height: 8px; left: 50%; position: absolute; radius: 50%; -webkit-transform: translate(-50%,-50%); -ms-transform: translate(-50%,-50%); transform: translate(-50%,-50%); top: 50%; width: 8px;}.fc-ab-root .fc-close-icon {border-radius: 50%; box-sizing: border-box; color: #5f6368; cursor: pointer; display: inline-block; font-family: 'Material Icons'; font-size: 20px; height: 40px; line-height: 40px; position: relative; text-align: center; vertical-align: middle; width: 40px;}.fc-ab-root .fc-close {box-sizing: border-box; color: white; cursor: pointer; direction: ltr; display: inline-block; font-size: 1em; height: 40px; margin: 0; opacity: 1; outline: none; text-align: center; text-indent: 0; width: 40px; z-index: 1; top: 0; right: 0; position: absolute;}.fc-ab-root .fc-close:focus {outline: none;}.fc-ab-root .fc-close:hover .fc-close-icon {color: #202124; background-color:  rgba(32, 33, 36, 0.04);}.fc-ab-root .fc-close:focus .fc-close-icon {color: #202124; background-color:  rgba(32, 33, 36, 0.12); outline: 1px solid #3c4043;}.fc-ab-root .fc-dialog-overlay, .fc-whitelist-root .fc-dialog-overlay {background-color: black; height: 100%; left: 0; opacity: 0.6; position: fixed; top: 0; width: 100%; z-index: -1;}.fc-ab-root .fc-dialog-container {z-index: 2147483644;align-items: center; display: flex; height: 100%; justify-content: center; width: 100%;left: 0; position: fixed; top: 0;}.fc-ab-root .fc-ab-dialog {align-items: center;border-radius: 8px; max-width: 600px; width: 90%;background: #ffffff;border: none;border-radius: 0.5em;padding-left: 1.5em; padding-right: 1.5em;padding-top: 1.5em; padding-bottom: 1.5em;box-sizing: border-box; display: flex; flex-direction: column; float: top; justify-content: center; max-height: 90%; min-width: 200px; position: relative;}@media screen and (max-width: 479px) {.fc-ab-root .fc-ab-dialog {font-size: 14px; line-height: 20px;}}@media screen and (min-width: 480px) {.fc-ab-root .fc-ab-dialog {font-size: 16px; line-height: 24px;}}.fc-ab-root .fc-ab-dialog > *:not(:last-child) {margin-bottom: 24px;}.fc-ab-root .fc-ab-dialog .fc-dialog-content {align-items: center; box-sizing: border-box; display: flex; flex-direction: column; overflow: auto; width: 100%;}.fc-ab-root .fc-ab-dialog .fc-dialog-content > *:not(:last-child) {margin-bottom: 16px;}.fc-ab-root .fc-ab-dialog .fc-dialog-content > * {flex-shrink: 0;}.fc-ab-root .fc-ab-dialog .fc-dialog-footer {align-items: center; box-sizing: border-box; display: flex; flex-direction: column; font-size: inherit; min-height: auto; justify-content: center;width: 100%;}.fc-ab-root .fc-ab-dialog .fc-dialog-footer .fc-footer-text {color: #5f6368; display: inline-block; font-size: 0.86em;}.fc-ab-root .fc-ab-dialog .fc-dialog-footer > div:not(:last-child) {margin-bottom: 16px;}.fc-ab-root .fc-dialog-headline {align-items: center; display: flex; flex-direction: column; justify-content: center; width: 100%;}.fc-ab-root .fc-dialog-headline > *:not(:last-child) {margin-bottom: 8px;}.fc-ab-root .fc-dialog-headline-text {overflow-wrap: break-word;font-weight: 700;font-style: normal;text-decoration: initial;text-align: center;font-family: 'Roboto';color: #323232;font-size: 1.75em;width: 100%;}.fc-ab-root .fc-header {display: flex; flex-direction: column; justify-content: center; width: 100%;}.fc-ab-root .fc-header-text {line-height: 1.5em;overflow-wrap: break-word;font-weight: 700;font-style: normal;text-decoration: initial;text-align: center;font-family: 'Roboto';color: #747a80;font-size: 1.25em;}.fc-ab-root .fc-header-image-container {display: flex; flex-direction: row;justify-content: center;}.fc-ab-root .fc-header-image {max-height: 60px; min-height: 40px; object-fit: contain;}.fc-ab-root .fc-dialog-body {display: flex; justify-content: center; width: 100%;}.fc-ab-root .fc-dialog-body-text {line-height: 1.5em; margin: 0; padding: 0; width: 100%;overflow-wrap: break-word;font-weight: normal;font-style: normal;text-decoration: initial;text-align: center;font-family: 'Roboto';color: #000000;font-size: 1.25em;}.fc-ab-root .fc-button {padding-left: 1em; padding-right: 1em;padding-top: 0.5em; padding-bottom: 0.5em;background: #fff;border: none;border-radius: 0.25em;overflow: hidden;box-sizing: border-box; align-items: center; display: inline-flex; justify-content: center; position: relative; width: 100%; z-index: 1;}.fc-ab-root .fc-button:not(:only-child) {}@supports (flex-wrap: wrap) and (gap: 16px) {@media screen and (min-width: 480px) {}}.fc-ab-root .fc-button .fc-button-background {background: #0099ff;border: none;height: 100%; left: 0; position: absolute; top: 0; transition: all 150ms ease-in; width: 100%; z-index: -1; -webkit-transition: all 150ms ease-in; -moz-transition: all 150ms ease-in; -o-transition: all 150ms ease-in; -ms-transition: all 150ms ease-in;}.fc-ab-root .fc-button.fc-secondary-button .fc-button-background {}.fc-ab-root .fc-button:hover:enabled .fc-button-background {filter: brightness(84%); transition: all 150ms ease-in; -webkit-transition: all 150ms ease-in; -moz-transition: all 150ms ease-in; -o-transition: all 150ms ease-in; -ms-transition: all 150ms ease-in;}.fc-ab-root .fc-button:focus:enabled .fc-button-background, .fc-ab-root .fc-button:active:enabled .fc-button-background {filter: brightness(61%); transition: all 150ms ease-in; -webkit-transition: all 150ms ease-in; -moz-transition: all 150ms ease-in; -o-transition: all 150ms ease-in; -ms-transition: all 150ms ease-in;}.fc-ab-root .fc-button-text {line-height: 1.25em; margin: 0; width: 100%;overflow-wrap: break-word;font-weight: 700;font-style: normal;text-decoration: initial;text-align: center;font-family: 'Roboto';color: #ffffff;font-size: 1.25em;}.fc-ab-root .fc-secondary-button > .fc-button-text {}.fc-ab-root .fc-button:disabled .fc-button-text {color: #9aa0a6; cursor: default;}.fc-ab-root .fc-button:disabled .fc-button-background {background-color: #dadce0; cursor: default;}.fc-ab-root .fc-buttons-section {align-items: center; display: flex; flex-direction: column; justify-content: center; max-width: 416px; width: 100%;}.fc-ab-root .fc-buttons-section > *:not(:last-child) {margin-bottom: 16px;}@supports (flex-wrap: wrap) and (gap: 16px) {.fc-ab-root .fc-buttons-section {flex-direction: unset; flex-wrap: wrap; -ms-flex-wrap: wrap; gap: 16px;}.fc-ab-root .fc-buttons-section > *:not(:last-child) {margin-bottom: 0;}}.fc-ab-root .fc-dialog-footer .fc-subscription-link {cursor: pointer; text-decoration: underline;overflow-wrap: break-word;font-weight: normal;font-style: normal;text-decoration: initial;text-align: center;font-family: 'Roboto';color: #4A90E2;font-size: 1em;}.fc-ab-root .fc-dialog-footer .fc-subscription-link {line-height: 1.25em; max-width: 400px;}.fc-whitelist-root .fc-whitelist-dialog-wrapper {align-items: center; display: flex; justify-content: center; height: 100%; left: 0; opacity: 1; position: fixed; top: 0; width: 100%;}.fc-whitelist-root .fc-whitelist-dialog {box-shadow: 1px -1px 16px #888888; border-radius: 2px; height: 100%; left: 0; max-height: 570px; max-width: 600px; top: 0; width: 100%;}</style><script async="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/AGSKWxUmGuCSQfOAyIi_JIoj-72-Ze3Eg5EmLGCwGsDp2L1AHrpp-YSfJ4O7nSmBtEbnXc8Oj1kP0kzHEdsPnrtASnnN3ojtF0oz6KjkMybVlwYAUKFoT2R6oUF" nonce="rXtwkqx90Oe6rsBXI5NpxA"></script></head>
<body class="post-template-default single single-post postid-2033 single-format-standard custom-background group-blog" data-new-gr-c-s-check-loaded="14.1159.0" data-gr-ext-installed="" style="" data-new-gr-c-s-loaded="14.1159.0">
<a class="sr-only sr-only-focusable" href="https://www.bezkoder.com/node-js-jwt-authentication-mysql/#content">Skip to main content</a>
<div id="page" class="hfeed site" style="position: relative;">
<header id="masthead" class="site-header" role="banner">
<nav class="navbar navbar-default 
		" role="navigation">
<div class="container">
<div class="row">
<div class="site-navigation-inner col-sm-12">
<div class="navbar-header">
<button type="button" class="btn navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<div id="logo">
<p class="site-name"> <a class="navbar-brand" href="https://www.bezkoder.com/" title="BezKoder" rel="home">BezKoder</a>
</p>

</div>
</div>

<div class="collapse navbar-collapse navbar-ex1-collapse"><ul id="menu-top-menu" class="nav navbar-nav"><li id="menu-item-8685" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-8685"><a href="https://www.bezkoder.com/category/courses/">Courses</a></li>
<li id="menu-item-1943" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1943"><a href="https://www.bezkoder.com/category/full-stack/">Full Stack</a></li>
<li id="menu-item-1059" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1059"><a href="https://www.bezkoder.com/category/spring/">Spring</a></li>
<li id="menu-item-3190" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3190"><a href="https://www.bezkoder.com/node-js-tutorial/">Node</a></li>
<li id="menu-item-266" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-266"><a href="https://www.bezkoder.com/category/vue/">Vue</a></li>
<li id="menu-item-2393" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2393"><a href="https://www.bezkoder.com/category/angular/">Angular</a></li>
<li id="menu-item-3149" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3149"><a href="https://www.bezkoder.com/category/react/">React</a></li>
<li id="menu-item-5129" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-5129"><a href="https://www.bezkoder.com/category/firebase/">Firebase</a></li>
<li id="menu-item-3150" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3150"><a href="https://www.bezkoder.com/category/django/">Django</a></li>
<li id="menu-item-121" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-121"><a href="https://www.bezkoder.com/category/dart/">Dart</a></li>
<li id="menu-item-2002" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2002"><a href="https://www.bezkoder.com/json-formatter/">JsonFormatter</a></li>
<li id="menu-item-9110" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-9110"><a href="https://www.bezkoder.com/categories/">Categories</a></li>
</ul></div> </div>
</div>
</div>
</nav>
</header>
<div id="content" class="site-content">
<div class="top-section">

</div>
<div class="container main-content-area">
<div class="row side-pull-left">
<div class="main-content-inner col-sm-12 col-md-8">
<div id="primary" class="content-area">
<main id="main" class="site-main" role="main">
<article id="post-2033" class="post-2033 post type-post status-publish format-standard has-post-thumbnail hentry category-node-js category-security tag-authentication tag-authorization tag-express tag-jwt tag-login tag-mysql tag-node-js tag-registration tag-rest-api tag-security tag-sequelize tag-token-based-authentication">
<div class="post-inner-content">
<header class="entry-header page-header">
<h1 class="entry-title ">Node.js Express: JWT example | Token Based Authentication &amp; Authorization</h1>
<div class="entry-meta">
<span class="posted-on"><i class="fa fa-calendar-alt"></i> <a href="https://www.bezkoder.com/node-js-jwt-authentication-mysql/" rel="bookmark"><time class="entry-date published" datetime="2023-10-16T04:07:51+00:00">Last modified: October 16, 2023</time></a></span><span class="byline"> <i class="fa fa-user"></i> <span class="author vcard"><a class="url fn n" href="https://www.bezkoder.com/author/bezkoder/">bezkoder</a></span></span>
<span class="cat-links"><i class="fa fa-folder-open"></i>
<a href="https://www.bezkoder.com/category/node-js/" rel="category tag">Node.js</a>, <a href="https://www.bezkoder.com/category/security/" rel="category tag">Security</a> </span>
</div>
</header>
<div class="entry-content">
<p>In this tutorial, we’re gonna build a Node.js Express Rest API example that supports Token Based Authentication with JWT (<a href="https://www.npmjs.com/package/jsonwebtoken">JSONWebToken</a>). You’ll know:</p>
<ul>
<li>Appropriate Flow for User Signup &amp; User Login with JWT Authentication</li>
<li>Node.js Express Architecture with CORS, Authentication &amp; Authorization middlewares &amp; Sequelize</li>
<li>How to configure Express routes to work with JWT</li>
<li>How to define Data Models and association for Authentication and Authorization</li>
<li>Way to use Sequelize to interact with MySQL Database</li>
</ul>
<p><span id="more-2033"></span></p>
<hr>
<p>Related Posts:<br>
– <a href="https://bezkoder.com/node-js-express-sequelize-mysql/">Node.js Rest APIs example with Express, Sequelize &amp; MySQL</a><br>
– <a href="https://bezkoder.com/node-js-mongodb-auth-jwt/">Node.js + MongoDB: User Authentication &amp; Authorization with JWT</a><br>
– <a href="https://bezkoder.com/node-js-jwt-authentication-postgresql/">Node.js + PostgreSQL: User Authentication &amp; Authorization with JWT</a></p>
<p>Fullstack (JWT Authentication &amp; Authorization example):<br>
– <a href="https://www.bezkoder.com/node-express-vue-jwt-auth/">Node Express + Vue</a><br>
– <a href="https://www.bezkoder.com/node-js-express-angular-jwt-auth/">Node Express + Angular 8</a><br>
– <a href="https://www.bezkoder.com/node-js-express-angular-10-jwt-auth/">Node Express + Angular 10</a><br>
– <a href="https://www.bezkoder.com/node-js-angular-11-jwt-authentication/">Node Express + Angular 11</a><br>
– <a href="https://www.bezkoder.com/node-js-angular-12-jwt-auth/">Node Express + Angular 12</a><br>
– <a href="https://www.bezkoder.com/node-js-angular-13-jwt-auth/">Node Express + Angular 13</a><br>
– <a href="https://www.bezkoder.com/node-js-angular-14-jwt-auth/">Node Express + Angular 14</a><br>
– <a href="https://www.bezkoder.com/node-js-angular-15-jwt-auth/">Node Express + Angular 15</a><br>
– <a href="https://www.bezkoder.com/node-js-angular-16-jwt-auth/">Node Express + Angular 16</a><br>
– <a href="https://www.bezkoder.com/react-express-authentication-jwt/">Node Express + React</a></p>
<p>Deployment:<br>
– <a href="https://bezkoder.com/deploy-node-js-app-heroku-cleardb-mysql/">Deploying/Hosting Node.js app on Heroku with MySQL database</a><br>
– <a href="https://www.bezkoder.com/docker-compose-nodejs-mysql/">Dockerize Node.js Express and MySQL example – Docker Compose</a></p>
<div id="toc_container" class="no_bullets">
<p class="toc_title">Contents <span class="toc_toggle">[<a href="https://www.bezkoder.com/node-js-jwt-authentication-mysql/#">hide</a>]</span></p>
<ul class="toc_list">
<li><a href="https://www.bezkoder.com/node-js-jwt-authentication-mysql/#Token_Based_Authentication">Token Based Authentication</a></li>
<li><a href="https://www.bezkoder.com/node-js-jwt-authentication-mysql/#Overview_of_Nodejs_JWT_Authentication_example">Overview of Node.js JWT Authentication example</a></li>
<li><a href="https://www.bezkoder.com/node-js-jwt-authentication-mysql/#Flow_for_Signup_038_Login_with_JWT_Authentication">Flow for Signup &amp; Login with JWT Authentication</a></li>
<li><a href="https://www.bezkoder.com/node-js-jwt-authentication-mysql/#Nodejs_Express_Architecture_with_Authentication_038_Authorization">Node.js Express Architecture with Authentication &amp; Authorization</a></li>
<li><a href="https://www.bezkoder.com/node-js-jwt-authentication-mysql/#Technology">Technology</a></li>
<li><a href="https://www.bezkoder.com/node-js-jwt-authentication-mysql/#Project_Structure">Project Structure</a></li>
<li><a href="https://www.bezkoder.com/node-js-jwt-authentication-mysql/#Create_Nodejs_App">Create Node.js App</a></li>
<li><a href="https://www.bezkoder.com/node-js-jwt-authentication-mysql/#Setup_Express_web_server">Setup Express web server</a></li>
<li><a href="https://www.bezkoder.com/node-js-jwt-authentication-mysql/#Configure_MySQL_database_038_Sequelize">Configure MySQL database &amp; Sequelize</a></li>
<li><a href="https://www.bezkoder.com/node-js-jwt-authentication-mysql/#Define_the_Sequelize_Model">Define the Sequelize Model</a></li>
<li><a href="https://www.bezkoder.com/node-js-jwt-authentication-mysql/#Initialize_Sequelize">Initialize Sequelize</a></li>
<li><a href="https://www.bezkoder.com/node-js-jwt-authentication-mysql/#Configure_Auth_Key">Configure Auth Key</a></li>
<li><a href="https://www.bezkoder.com/node-js-jwt-authentication-mysql/#Create_Middleware_functions">Create Middleware functions</a></li>
<li><a href="https://www.bezkoder.com/node-js-jwt-authentication-mysql/#Create_Controllers">Create Controllers</a>
<ul>
<li><a href="https://www.bezkoder.com/node-js-jwt-authentication-mysql/#Controller_for_Authentication">Controller for Authentication</a></li>
<li><a href="https://www.bezkoder.com/node-js-jwt-authentication-mysql/#Controller_for_testing_Authorization">Controller for testing Authorization</a></li>
</ul>
</li>
<li><a href="https://www.bezkoder.com/node-js-jwt-authentication-mysql/#Define_Routes">Define Routes</a></li>
<li><a href="https://www.bezkoder.com/node-js-jwt-authentication-mysql/#Run_Test_with_Results">Run &amp; Test with Results</a></li>
<li><a href="https://www.bezkoder.com/node-js-jwt-authentication-mysql/#Conclusion">Conclusion</a></li>
<li><a href="https://www.bezkoder.com/node-js-jwt-authentication-mysql/#Source_Code">Source Code</a></li>
<li><a href="https://www.bezkoder.com/node-js-jwt-authentication-mysql/#Further_Reading">Further Reading</a></li>
</ul>
</div>
<h2><span id="Token_Based_Authentication">Token Based Authentication</span></h2>
<p>Comparing with Session-based Authentication that need to store Session on Cookie, the big advantage of Token-based Authentication is that we store the JSON Web Token (JWT) on Client side: Local Storage for Browser, Keychain for IOS and SharedPreferences for Android… So we don’t need to build another backend project that supports Native Apps or an additional Authentication module for Native App users.</p>
<p><img fetchpriority="high" decoding="async" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/in-depth-introduction-jwt-token-based-authentication.png" data-src="https://bezkoder.com/wp-content/uploads/2019/10/in-depth-introduction-jwt-token-based-authentication.png" alt="in-depth-introduction-jwt-token-based-authentication" width="640" height="460" class="alignnone size-full wp-image-733 lazyloaded"><noscript><img decoding="async" src="https://bezkoder.com/wp-content/uploads/2019/10/in-depth-introduction-jwt-token-based-authentication.png" alt="in-depth-introduction-jwt-token-based-authentication" width="640" height="460" class="alignnone size-full wp-image-733 lazyload" srcset="https://www.bezkoder.com/wp-content/uploads/2019/10/in-depth-introduction-jwt-token-based-authentication.png 640w, https://www.bezkoder.com/wp-content/uploads/2019/10/in-depth-introduction-jwt-token-based-authentication-300x216.png 300w" sizes="(max-width: 640px) 100vw, 640px" /></noscript></p>

<div class="quads-location quads-ad1" id="quads-ad1" style="float: none; margin: 15px 0px; text-align: center; visibility: visible;">
<script async="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/f(1).txt" crossorigin="anonymous" type="text/javascript"></script>

<ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9222145312954144" data-ad-slot="2617909532" data-ad-format="auto" data-full-width-responsive="true"></ins>
<script type="text/javascript">
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<p>There are three important parts of a JWT: Header, Payload, Signature. Together they are combined to a standard structure: <code>header.payload.signature</code>.</p>
<p>The Client typically attaches JWT in <strong>Authorization</strong> header with Bearer prefix:</p>
<pre><code>Authorization: Bearer [header].[payload].[signature]
</code></pre>
<p>Or only in <strong>x-access-token</strong> header:</p>
<pre><code>x-access-token: [header].[payload].[signature]
</code></pre>
<p>For more details, you can visit:<br>
<a href="https://bezkoder.com/jwt-json-web-token/">In-depth Introduction to JWT-JSON Web Token</a></p>
<h2><span id="Overview_of_Nodejs_JWT_Authentication_example">Overview of Node.js Express JWT Authentication example</span></h2>
<p>We will build a Node.js Express application in that:</p>
<ul>
<li>User can signup new account, or login with username &amp; password.</li>
<li>By User’s role (admin, moderator, user), we authorize the User to access resources</li>
</ul>
<p>This is our Node.js application demo running with MySQL database and test Rest Apis with Postman.</p>
<p><iframe class=" lazyloaded" width="560" height="315" data-src="https://www.youtube.com/embed/fLcxkyMDW08?rel=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/fLcxkyMDW08.html"></iframe></p>
<p>These are APIs that we need to provide:</p>

<div class="quads-location quads-ad4" id="quads-ad4" style="float: none; margin: 20px 0px; text-align: center; visibility: visible;">
<script async="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/f(1).txt" crossorigin="anonymous" type="text/javascript"></script>

<ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9222145312954144" data-ad-slot="5596689762" data-ad-format="auto" data-full-width-responsive="true"></ins>
<script type="text/javascript">
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div class="table-responsive">
<table class="table table-hover  table table-hover table table-hover" width="100%">
<thead>
<tr>
<th>Methods</th>
<th>Urls</th>
<th>Actions</th>
</tr>
</thead>
<tbody>
<tr>
<td>POST</td>
<td>/api/auth/signup</td>
<td>signup new account</td>
</tr>
<tr>
<td>POST</td>
<td>/api/auth/signin</td>
<td>login an account</td>
</tr>
<tr>
<td>GET</td>
<td>/api/test/all</td>
<td>retrieve public content</td>
</tr>
<tr>
<td>GET</td>
<td>/api/test/user</td>
<td>access User’s content</td>
</tr>
<tr>
<td>GET</td>
<td>/api/test/mod</td>
<td>access Moderator’s content</td>
</tr>
<tr>
<td>GET</td>
<td>/api/test/admin</td>
<td>access Admin’s content</td>
</tr>
</tbody>
</table>
</div>
<h2><span id="Flow_for_Signup_038_Login_with_JWT_Authentication">Flow for Signup &amp; Login with JWT Authentication</span></h2>
<p>The diagram shows flow of User Registration, User Login and Authorization process.</p>
<p><img decoding="async" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/node-js-jwt-authentication-mysql-flow.png" data-src="https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-flow.png" alt="node-js-jwt-authentication-mysql-flow" width="672" height="500" class="alignnone size-full wp-image-2014 lazyloaded"><noscript><img decoding="async" src="https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-flow.png" alt="node-js-jwt-authentication-mysql-flow" width="672" height="500" class="alignnone size-full wp-image-2014 lazyload" srcset="https://www.bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-flow.png 672w, https://www.bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-flow-300x223.png 300w" sizes="(max-width: 672px) 100vw, 672px" /></noscript></p>
<p>A legal JWT must be added to HTTP <strong>x-access-token</strong> Header if Client accesses protected resources.</p>
<p>You will need to implement Refresh Token:</p>

<div class="quads-location quads-ad2" id="quads-ad2" style="float: none; margin: 30px 0px; text-align: center; visibility: visible;">
<script async="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/f.txt" type="text/javascript"></script>
<ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-9222145312954144" data-ad-slot="8580577265"></ins>
<script type="text/javascript">
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<p><img decoding="async" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/jwt-refresh-token-node-js-example-flow.png" data-src="https://bezkoder.com/wp-content/uploads/2021/05/jwt-refresh-token-node-js-example-flow.png" alt="jwt-refresh-token-node-js-example-flow" width="700" height="450" class="alignnone size-full wp-image-7460 lazyloaded"><noscript><img decoding="async" src="https://bezkoder.com/wp-content/uploads/2021/05/jwt-refresh-token-node-js-example-flow.png" alt="jwt-refresh-token-node-js-example-flow" width="700" height="450" class="alignnone size-full wp-image-7460 lazyload" srcset="https://www.bezkoder.com/wp-content/uploads/2021/05/jwt-refresh-token-node-js-example-flow.png 700w, https://www.bezkoder.com/wp-content/uploads/2021/05/jwt-refresh-token-node-js-example-flow-300x193.png 300w" sizes="(max-width: 700px) 100vw, 700px" /></noscript></p>
<p>More details at: <a href="https://bezkoder.com/jwt-refresh-token-node-js/">JWT Refresh Token implementation in Node.js example</a></p>
<p>If you want to use Httponly Cookies, please visit:<br>
<a href="https://www.bezkoder.com/node-js-express-login-example/">Node.js Express: Login and Registration example with JWT</a></p>
<h2><span id="Nodejs_Express_Architecture_with_Authentication_038_Authorization">Node.js Express Architecture with Authentication &amp; Authorization</span></h2>
<p>You can have an overview of our Node.js Express App with the diagram below:</p>
<p><img decoding="async" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/node-js-jwt-authentication-mysql-architecture.png" data-src="https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-architecture.png" alt="node-js-jwt-authentication-mysql-architecture" width="564" height="564" class="alignnone size-full wp-image-2015 lazyloaded"><noscript><img decoding="async" src="https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-architecture.png" alt="node-js-jwt-authentication-mysql-architecture" width="564" height="564" class="alignnone size-full wp-image-2015 lazyload" srcset="https://www.bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-architecture.png 564w, https://www.bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-architecture-300x300.png 300w, https://www.bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-architecture-150x150.png 150w, https://www.bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-architecture-60x60.png 60w" sizes="(max-width: 564px) 100vw, 564px" /></noscript></p>
<p>Via <em>Express</em> routes, <strong>HTTP request</strong> that matches a route will be checked by <strong>CORS Middleware</strong> before coming to <strong>Security</strong> layer.</p>
<p><strong>Security</strong> layer includes:</p>
<ul>
<li>JWT Authentication Middleware: verify SignUp, verify token</li>
<li>Authorization Middleware: check User’s roles with record in database</li>
</ul>
<p>If these middlewares throw any error, a message will be sent as HTTP response.</p>
<p><strong>Controllers</strong> interact with MySQL Database via <em>Sequelize</em> and send <strong>HTTP response</strong> (token, user information, data based on roles…) to client.</p>
<h2><span id="Technology">Technology</span></h2>
<ul>
<li>Express 4.18.2</li>
<li>bcryptjs 2.4.3</li>
<li>jsonwebtoken 9.0.0</li>
<li>Sequelize 6.32.1</li>
<li>MySQL</li>
</ul>
<h2><span id="Project_Structure">Project Structure</span></h2>
<p>This is directory structure for our Node.js Express application:</p>
<p><img decoding="async" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/node-js-jwt-authentication-mysql-project-structure.png" data-src="https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-project-structure.png" alt="node-js-jwt-authentication-mysql-project-structure" width="220" height="520" class="alignnone size-full wp-image-2061 lazyloaded"><noscript><img decoding="async" src="https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-project-structure.png" alt="node-js-jwt-authentication-mysql-project-structure" width="220" height="520" class="alignnone size-full wp-image-2061 lazyload" srcset="https://www.bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-project-structure.png 220w, https://www.bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-project-structure-127x300.png 127w" sizes="(max-width: 220px) 100vw, 220px" /></noscript></p>
<p>– <strong>config</strong></p>
<ul>
<li>configure MySQL database &amp; Sequelize</li>
<li>configure Auth Key</li>
</ul>
<p>– <strong>routes</strong></p>
<ul>
<li><em>auth.routes.js</em>: POST signup &amp; signin</li>
<li><em>user.routes.js</em>: GET public &amp; protected resources</li>
</ul>
<p>– <strong>middlewares</strong></p>
<ul>
<li><em>verifySignUp.js</em>: check duplicate Username or Email</li>
<li><em>authJwt.js</em>: verify Token, check User roles in database</li>
</ul>
<p>– <strong>controllers</strong></p>
<ul>
<li><em>auth.controller.js</em>: handle signup &amp; signin actions</li>
<li><em>user.controller.js</em>: return public &amp; protected content</li>
</ul>
<p>– <strong>models</strong> for Sequelize Models</p>
<ul>
<li><em>user.model.js</em></li>
<li><em>role.model.js</em></li>
</ul>
<p>– <em>server.js</em>: import and initialize necessary modules and routes, listen for connections.</p>
<h2><span id="Create_Nodejs_App">Create Node.js App</span></h2>
<p>First, we create a folder for our project:</p>
<pre><code>$ mkdir node-js-jwt-auth
$ cd node-js-jwt-auth
</code></pre>
<p>Then we initialize the Node.js App with a <em>package.json</em> file:</p>
<pre><code>npm init

name: (node-js-jwt-auth) 
version: (1.0.0) 
description: Node.js Demo for JWT Authentication
entry point: (index.js) server.js
test command: 
git repository: 
keywords: node.js, express, jwt, authentication, mysql
author: bezkoder
license: (ISC)

Is this ok? (yes) yes
</code></pre>
<p>We need to install necessary modules: <code>express</code>, <code>cors</code>, <code>sequelize</code>, <code>mysql2</code>, <code>jsonwebtoken</code> and <code>bcryptjs</code>.<br>
Run the command:</p>
<pre><code>npm install express sequelize mysql2 cors jsonwebtoken bcryptjs --save
</code></pre>
<p>The package.json file now looks like this:</p>
<pre class=" language-json"><code class=" language-json"><span class="token punctuation">{</span>
  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"node-js-jwt-auth"</span><span class="token punctuation">,</span>
  <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"1.0.0"</span><span class="token punctuation">,</span>
  <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"Node.js Demo for JWT Authentication"</span><span class="token punctuation">,</span>
  <span class="token property">"main"</span><span class="token operator">:</span> <span class="token string">"server.js"</span><span class="token punctuation">,</span>
  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"test"</span><span class="token operator">:</span> <span class="token string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"keywords"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">"node.js"</span><span class="token punctuation">,</span>
    <span class="token string">"jwt"</span><span class="token punctuation">,</span>
    <span class="token string">"authentication"</span><span class="token punctuation">,</span>
    <span class="token string">"express"</span><span class="token punctuation">,</span>
    <span class="token string">"mysql"</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"author"</span><span class="token operator">:</span> <span class="token string">"bezkoder"</span><span class="token punctuation">,</span>
  <span class="token property">"license"</span><span class="token operator">:</span> <span class="token string">"ISC"</span><span class="token punctuation">,</span>
  <span class="token property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"bcryptjs"</span><span class="token operator">:</span> <span class="token string">"^2.4.3"</span><span class="token punctuation">,</span>
    <span class="token property">"cors"</span><span class="token operator">:</span> <span class="token string">"^2.8.5"</span><span class="token punctuation">,</span>
    <span class="token property">"express"</span><span class="token operator">:</span> <span class="token string">"^4.18.2"</span><span class="token punctuation">,</span>
    <span class="token property">"jsonwebtoken"</span><span class="token operator">:</span> <span class="token string">"^9.0.0"</span><span class="token punctuation">,</span>
    <span class="token property">"mysql2"</span><span class="token operator">:</span> <span class="token string">"^2.3.3"</span><span class="token punctuation">,</span>
    <span class="token property">"sequelize"</span><span class="token operator">:</span> <span class="token string">"^6.32.1"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h2><span id="Setup_Express_web_server">Setup Express web server</span></h2>
<p>In the root folder, let’s create a new <em>server.js</em> file:</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"express"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cors <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"cors"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> corsOptions <span class="token operator">=</span> <span class="token punctuation">{</span>
  origin<span class="token operator">:</span> <span class="token string">"http://localhost:8081"</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token function">cors</span><span class="token punctuation">(</span>corsOptions<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// parse requests of content-type - application/json</span>
app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// parse requests of content-type - application/x-www-form-urlencoded</span>
app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token method function property-access">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">{</span> extended<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// simple route</span>
app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> message<span class="token operator">:</span> <span class="token string">"Welcome to bezkoder application."</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// set port, listen for requests</span>
<span class="token keyword">const</span> <span class="token constant">PORT</span> <span class="token operator">=</span> process<span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">PORT</span> <span class="token operator">||</span> <span class="token number">8080</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token method function property-access">listen</span><span class="token punctuation">(</span><span class="token constant">PORT</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Server is running on port </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">PORT</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Let me explain what we’ve just done:<br>
– import <code>express</code> and <code>cors</code> modules:</p>
<ul>
<li>Express is for building the Rest apis</li>
<li><a href="https://www.npmjs.com/package/cors">cors</a> provides Express middleware to enable CORS</li>
</ul>
<p>– create an Express app, then add request body parser and <code>cors</code> middlewares using <code>app.use()</code> method. Notice that we set origin: <code>http://localhost:8081</code>.<br>
– define a GET route which is simple for test.<br>
– listen on port 8080 for incoming requests.</p>
<p>Now let’s run the app with command: <code>node server.js</code>.<br>
Open your browser with url <a href="http://localhost:8080/">http://localhost:8080/</a>, you will see:</p>
<p><img decoding="async" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/node-js-jwt-authentication-mysql-example-setup-server.png" data-src="https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-example-setup-server.png" alt="node-js-jwt-authentication-mysql-example-setup-server" width="394" height="144" class="alignnone size-full wp-image-2019 lazyloaded"><noscript><img decoding="async" src="https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-example-setup-server.png" alt="node-js-jwt-authentication-mysql-example-setup-server" width="394" height="144" class="alignnone size-full wp-image-2019 lazyload" srcset="https://www.bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-example-setup-server.png 394w, https://www.bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-example-setup-server-300x110.png 300w" sizes="(max-width: 394px) 100vw, 394px" /></noscript></p>
<h2><span id="Configure_MySQL_database_038_Sequelize">Configure MySQL database &amp; Sequelize</span></h2>
<p>In the <strong>app</strong> folder, create <strong>config</strong> folder for configuration with <em>db.config.js</em> file like this:</p>
<pre class=" language-js"><code class=" language-js">module<span class="token punctuation">.</span><span class="token property-access">exports</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">HOST</span><span class="token operator">:</span> <span class="token string">"localhost"</span><span class="token punctuation">,</span>
  <span class="token constant">USER</span><span class="token operator">:</span> <span class="token string">"root"</span><span class="token punctuation">,</span>
  <span class="token constant">PASSWORD</span><span class="token operator">:</span> <span class="token string">"123456"</span><span class="token punctuation">,</span>
  <span class="token constant">DB</span><span class="token operator">:</span> <span class="token string">"testdb"</span><span class="token punctuation">,</span>
  dialect<span class="token operator">:</span> <span class="token string">"mysql"</span><span class="token punctuation">,</span>
  pool<span class="token operator">:</span> <span class="token punctuation">{</span>
    max<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
    min<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    acquire<span class="token operator">:</span> <span class="token number">30000</span><span class="token punctuation">,</span>
    idle<span class="token operator">:</span> <span class="token number">10000</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>First five parameters are for MySQL connection.<br>
<code>pool</code> is optional, it will be used for Sequelize connection pool configuration:</p>
<ul>
<li><code>max</code>: maximum number of connection in pool</li>
<li><code>min</code>: minimum number of connection in pool</li>
<li><code>idle</code>: maximum time, in milliseconds, that a connection can be idle before being released</li>
<li><code>acquire</code>: maximum time, in milliseconds, that pool will try to get connection before throwing error</li>
</ul>
<p>For more details, please visit <a href="https://sequelize.org/master/class/lib/sequelize.js~Sequelize.html#instance-constructor-constructor">API Reference for the Sequelize constructor</a>.</p>
<h2><span id="Define_the_Sequelize_Model">Define the Sequelize Model</span></h2>
<p>In <em>models</em> folder, create <code>User</code> and <code>Role</code> data model as following code:</p>
<p><strong>models</strong>/<em>user.model.js</em></p>
<pre class=" language-js"><code class=" language-js">module<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">sequelize<span class="token punctuation">,</span> <span class="token maybe-class-name">Sequelize</span></span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token maybe-class-name">User</span> <span class="token operator">=</span> sequelize<span class="token punctuation">.</span><span class="token method function property-access">define</span><span class="token punctuation">(</span><span class="token string">"users"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    username<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> <span class="token maybe-class-name">Sequelize</span><span class="token punctuation">.</span><span class="token constant">STRING</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    email<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> <span class="token maybe-class-name">Sequelize</span><span class="token punctuation">.</span><span class="token constant">STRING</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    password<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> <span class="token maybe-class-name">Sequelize</span><span class="token punctuation">.</span><span class="token constant">STRING</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token maybe-class-name">User</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p><strong>models</strong>/<em>role.model.js</em></p>
<pre class=" language-js"><code class=" language-js">module<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">sequelize<span class="token punctuation">,</span> <span class="token maybe-class-name">Sequelize</span></span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token maybe-class-name">Role</span> <span class="token operator">=</span> sequelize<span class="token punctuation">.</span><span class="token method function property-access">define</span><span class="token punctuation">(</span><span class="token string">"roles"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> <span class="token maybe-class-name">Sequelize</span><span class="token punctuation">.</span><span class="token constant">INTEGER</span><span class="token punctuation">,</span>
      primaryKey<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> <span class="token maybe-class-name">Sequelize</span><span class="token punctuation">.</span><span class="token constant">STRING</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token maybe-class-name">Role</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>These Sequelize Models represents <strong>users</strong> &amp; <strong>roles</strong> table in MySQL database.</p>
<p>After initializing Sequelize, we don’t need to write CRUD functions, Sequelize supports all of them:</p>
<ul>
<li>create a new User: <code><a href="https://sequelize.org/master/class/lib/model.js~Model.html#static-method-create">create</a>(object)</code></li>
<li>find a User by id: <code><a href="https://sequelize.org/master/class/lib/model.js~Model.html#static-method-findByPk">findByPk</a>(id)</code></li>
<li>find a User by email: <code><a href="https://sequelize.org/master/class/lib/model.js~Model.html#static-method-findOne">findOne</a>({ where: { email: ... } })</code></li>
<li>get all Users: <code><a href="https://sequelize.org/master/class/lib/model.js~Model.html#static-method-findAll">findAll</a>()</code></li>
<li>find all Users by <em>username</em>: <code>findAll({ where: { username: ... } })</code></li>
</ul>
<p>These functions will be used in our Controllers and Middlewares.</p>
<h2><span id="Initialize_Sequelize">Initialize Sequelize</span></h2>
<p>Now create <strong>app</strong>/<strong>models</strong>/<em>index.js</em> with content like this:</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"../config/db.config.js"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token maybe-class-name">Sequelize</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"sequelize"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> sequelize <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Sequelize</span><span class="token punctuation">(</span>
  config<span class="token punctuation">.</span><span class="token constant">DB</span><span class="token punctuation">,</span>
  config<span class="token punctuation">.</span><span class="token constant">USER</span><span class="token punctuation">,</span>
  config<span class="token punctuation">.</span><span class="token constant">PASSWORD</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    host<span class="token operator">:</span> config<span class="token punctuation">.</span><span class="token constant">HOST</span><span class="token punctuation">,</span>
    dialect<span class="token operator">:</span> config<span class="token punctuation">.</span><span class="token property-access">dialect</span><span class="token punctuation">,</span>
    pool<span class="token operator">:</span> <span class="token punctuation">{</span>
      max<span class="token operator">:</span> config<span class="token punctuation">.</span><span class="token property-access">pool</span><span class="token punctuation">.</span><span class="token property-access">max</span><span class="token punctuation">,</span>
      min<span class="token operator">:</span> config<span class="token punctuation">.</span><span class="token property-access">pool</span><span class="token punctuation">.</span><span class="token property-access">min</span><span class="token punctuation">,</span>
      acquire<span class="token operator">:</span> config<span class="token punctuation">.</span><span class="token property-access">pool</span><span class="token punctuation">.</span><span class="token property-access">acquire</span><span class="token punctuation">,</span>
      idle<span class="token operator">:</span> config<span class="token punctuation">.</span><span class="token property-access">pool</span><span class="token punctuation">.</span><span class="token property-access">idle</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

db<span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">Sequelize</span></span> <span class="token operator">=</span> <span class="token maybe-class-name">Sequelize</span><span class="token punctuation">;</span>
db<span class="token punctuation">.</span><span class="token property-access">sequelize</span> <span class="token operator">=</span> sequelize<span class="token punctuation">;</span>

db<span class="token punctuation">.</span><span class="token property-access">user</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"../models/user.model.js"</span><span class="token punctuation">)</span><span class="token punctuation">(</span>sequelize<span class="token punctuation">,</span> <span class="token maybe-class-name">Sequelize</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
db<span class="token punctuation">.</span><span class="token property-access">role</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"../models/role.model.js"</span><span class="token punctuation">)</span><span class="token punctuation">(</span>sequelize<span class="token punctuation">,</span> <span class="token maybe-class-name">Sequelize</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

db<span class="token punctuation">.</span><span class="token property-access">role</span><span class="token punctuation">.</span><span class="token method function property-access">belongsToMany</span><span class="token punctuation">(</span>db<span class="token punctuation">.</span><span class="token property-access">user</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  through<span class="token operator">:</span> <span class="token string">"user_roles"</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
db<span class="token punctuation">.</span><span class="token property-access">user</span><span class="token punctuation">.</span><span class="token method function property-access">belongsToMany</span><span class="token punctuation">(</span>db<span class="token punctuation">.</span><span class="token property-access">role</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  through<span class="token operator">:</span> <span class="token string">"user_roles"</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

db<span class="token punctuation">.</span><span class="token constant">ROLES</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"user"</span><span class="token punctuation">,</span> <span class="token string">"admin"</span><span class="token punctuation">,</span> <span class="token string">"moderator"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span><span class="token property-access">exports</span> <span class="token operator">=</span> db<span class="token punctuation">;</span>
</code></pre>
<p>The association between <em>Users</em> and <em>Roles</em> is Many-to-Many relationship:<br>
– One User can have several Roles.<br>
– One Role can be taken on by many Users.</p>
<p>We use <code>User.belongsToMany(Role)</code> to indicate that the <em>user</em> model can belong to many <em>Role</em>s and vice versa.</p>
<p>With <code>through</code>, we’re gonna have a new table <strong>user_roles</strong> as connection between <strong>users</strong> and <strong>roles</strong> table via their primary key as foreign keys.</p>
<p>If you want to know more details about how to make Many-to-Many Association with Sequelize and Node.js, please visit:<br>
<a href="https://bezkoder.com/sequelize-associate-many-to-many/">Sequelize Many-to-Many Association example – Node.js &amp; MySQL</a></p>
<p>Don’t forget to call <code>sync()</code> method in <em>server.js</em>.</p>
<pre class=" language-js"><code class=" language-js"><span class="token spread operator">...</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token spread operator">...</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"./app/models"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token maybe-class-name">Role</span> <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token property-access">role</span><span class="token punctuation">;</span>

db<span class="token punctuation">.</span><span class="token property-access">sequelize</span><span class="token punctuation">.</span><span class="token method function property-access">sync</span><span class="token punctuation">(</span><span class="token punctuation">{</span>force<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'Drop and Resync Db'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">initial</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token spread operator">...</span>
<span class="token keyword">function</span> <span class="token function">initial</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token maybe-class-name">Role</span><span class="token punctuation">.</span><span class="token method function property-access">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">"user"</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token maybe-class-name">Role</span><span class="token punctuation">.</span><span class="token method function property-access">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">"moderator"</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token maybe-class-name">Role</span><span class="token punctuation">.</span><span class="token method function property-access">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">"admin"</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p><code>initial()</code> function helps us to create 3 rows in database.<br>
In development, you may need to drop existing tables and re-sync database. So you can use <code>force: true</code> as code above.</p>
<p>For production, just insert these rows manually and use <code>sync()</code> without parameters to avoid dropping data:</p>
<pre class=" language-js"><code class=" language-js"><span class="token spread operator">...</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token spread operator">...</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"./app/models"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

db<span class="token punctuation">.</span><span class="token property-access">sequelize</span><span class="token punctuation">.</span><span class="token method function property-access">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token spread operator">...</span>
</code></pre>
<p>Learn how to implement Sequelize One-to-Many Relationship at:<br>
<a href="https://bezkoder.com/sequelize-associate-one-to-many/">Sequelize Associations: One-to-Many example – Node.js, MySQL</a></p>
<h2><span id="Configure_Auth_Key">Configure Auth Key</span></h2>
<p><strong>jsonwebtoken</strong> functions such as <code>verify()</code> or <code>sign()</code> use algorithm that needs a secret key (as String) to encode and decode token.</p>
<p>In the <strong>app</strong>/<strong>config</strong> folder, create <em>auth.config.js</em> file with following code:</p>
<pre class=" language-js"><code class=" language-js">module<span class="token punctuation">.</span><span class="token property-access">exports</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  secret<span class="token operator">:</span> <span class="token string">"bezkoder-secret-key"</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>You can create your own <code>secret</code> String.</p>
<h2><span id="Create_Middleware_functions">Create Middleware functions</span></h2>
<p>To verify a Signup action, we need 2 functions:<br>
– check if <code>username</code> or <code>email</code> is duplicate or not<br>
– check if <code>roles</code> in the request is existed or not</p>
<p><strong>middleware</strong>/<em>verifySignUp.js</em></p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"../models"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">ROLES</span> <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token constant">ROLES</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token maybe-class-name">User</span> <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token property-access">user</span><span class="token punctuation">;</span>

<span class="token function-variable function">checkDuplicateUsernameOrEmail</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// Username</span>
  <span class="token maybe-class-name">User</span><span class="token punctuation">.</span><span class="token method function property-access">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    where<span class="token operator">:</span> <span class="token punctuation">{</span>
      username<span class="token operator">:</span> req<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token property-access">username</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">user</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        message<span class="token operator">:</span> <span class="token string">"Failed! Username is already in use!"</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Email</span>
    <span class="token maybe-class-name">User</span><span class="token punctuation">.</span><span class="token method function property-access">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      where<span class="token operator">:</span> <span class="token punctuation">{</span>
        email<span class="token operator">:</span> req<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token property-access">email</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">user</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          message<span class="token operator">:</span> <span class="token string">"Failed! Email is already in use!"</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function-variable function">checkRolesExisted</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token property-access">roles</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> req<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token property-access">roles</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token constant">ROLES</span><span class="token punctuation">.</span><span class="token method function property-access">includes</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token property-access">roles</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          message<span class="token operator">:</span> <span class="token string">"Failed! Role does not exist = "</span> <span class="token operator">+</span> req<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token property-access">roles</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> verifySignUp <span class="token operator">=</span> <span class="token punctuation">{</span>
  checkDuplicateUsernameOrEmail<span class="token operator">:</span> checkDuplicateUsernameOrEmail<span class="token punctuation">,</span>
  checkRolesExisted<span class="token operator">:</span> checkRolesExisted
<span class="token punctuation">}</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span><span class="token property-access">exports</span> <span class="token operator">=</span> verifySignUp<span class="token punctuation">;</span>
</code></pre>
<p>To process Authentication &amp; Authorization, we have these functions:<br>
- check if <code>token</code> is provided, legal or not. We get token from <strong>x-access-token</strong> of HTTP headers, then use <strong>jsonwebtoken</strong>'s <code>verify()</code> function.<br>
- check if <code>roles</code> of the user contains required role or not.</p>
<p><strong>middleware</strong>/<em>authJwt.js</em></p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> jwt <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"jsonwebtoken"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"../config/auth.config.js"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"../models"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token maybe-class-name">User</span> <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token property-access">user</span><span class="token punctuation">;</span>

<span class="token function-variable function">verifyToken</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> token <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token property-access">headers</span><span class="token punctuation">[</span><span class="token string">"x-access-token"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>token<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">403</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      message<span class="token operator">:</span> <span class="token string">"No token provided!"</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  jwt<span class="token punctuation">.</span><span class="token method function property-access">verify</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span>
            config<span class="token punctuation">.</span><span class="token property-access">secret</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> decoded</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
              <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">401</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                  message<span class="token operator">:</span> <span class="token string">"Unauthorized!"</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span>
              req<span class="token punctuation">.</span><span class="token property-access">userId</span> <span class="token operator">=</span> decoded<span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">;</span>
              <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function-variable function">isAdmin</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token maybe-class-name">User</span><span class="token punctuation">.</span><span class="token method function property-access">findByPk</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token property-access">userId</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">user</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
    user<span class="token punctuation">.</span><span class="token method function property-access">getRoles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">roles</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> roles<span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>roles<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token property-access">name</span> <span class="token operator">===</span> <span class="token string">"admin"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>

      res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">403</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        message<span class="token operator">:</span> <span class="token string">"Require Admin Role!"</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function-variable function">isModerator</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token maybe-class-name">User</span><span class="token punctuation">.</span><span class="token method function property-access">findByPk</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token property-access">userId</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">user</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
    user<span class="token punctuation">.</span><span class="token method function property-access">getRoles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">roles</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> roles<span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>roles<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token property-access">name</span> <span class="token operator">===</span> <span class="token string">"moderator"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>

      res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">403</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        message<span class="token operator">:</span> <span class="token string">"Require Moderator Role!"</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function-variable function">isModeratorOrAdmin</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token maybe-class-name">User</span><span class="token punctuation">.</span><span class="token method function property-access">findByPk</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token property-access">userId</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">user</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
    user<span class="token punctuation">.</span><span class="token method function property-access">getRoles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">roles</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> roles<span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>roles<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token property-access">name</span> <span class="token operator">===</span> <span class="token string">"moderator"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>roles<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token property-access">name</span> <span class="token operator">===</span> <span class="token string">"admin"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>

      res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">403</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        message<span class="token operator">:</span> <span class="token string">"Require Moderator or Admin Role!"</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> authJwt <span class="token operator">=</span> <span class="token punctuation">{</span>
  verifyToken<span class="token operator">:</span> verifyToken<span class="token punctuation">,</span>
  isAdmin<span class="token operator">:</span> isAdmin<span class="token punctuation">,</span>
  isModerator<span class="token operator">:</span> isModerator<span class="token punctuation">,</span>
  isModeratorOrAdmin<span class="token operator">:</span> isModeratorOrAdmin
<span class="token punctuation">}</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span><span class="token property-access">exports</span> <span class="token operator">=</span> authJwt<span class="token punctuation">;</span>
</code></pre>
<p><strong>middleware</strong>/<em>index.js</em></p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> authJwt <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"./authJwt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> verifySignUp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"./verifySignUp"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span><span class="token property-access">exports</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  authJwt<span class="token punctuation">,</span>
  verifySignUp
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<h2><span id="Create_Controllers">Create Controllers</span></h2>
<h3><span id="Controller_for_Authentication">Controller for Authentication</span></h3>
<p>There are 2 main functions for Authentication:<br>
- <code>signup</code>: create new User in database (role is <strong>user</strong> if not specifying role)<br>
- <code>signin</code>:</p>
<ul>
<li>find <code>username</code> of the request in database, if it exists</li>
<li>compare <code>password</code> with <code>password</code> in database using <strong>bcrypt</strong>, if it is correct</li>
<li>generate a token using <strong>jsonwebtoken</strong></li>
<li>return user information &amp; access Token</li>
</ul>
<p><strong>controllers</strong>/<em>auth.controller.js</em></p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"../models"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"../config/auth.config"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token maybe-class-name">User</span> <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token property-access">user</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token maybe-class-name">Role</span> <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token property-access">role</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token maybe-class-name">Op</span> <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">Sequelize</span></span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">Op</span></span><span class="token punctuation">;</span>

<span class="token keyword">var</span> jwt <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"jsonwebtoken"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> bcrypt <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"bcryptjs"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

exports<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">signup</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// Save User to Database</span>
  <span class="token maybe-class-name">User</span><span class="token punctuation">.</span><span class="token method function property-access">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    username<span class="token operator">:</span> req<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token property-access">username</span><span class="token punctuation">,</span>
    email<span class="token operator">:</span> req<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token property-access">email</span><span class="token punctuation">,</span>
    password<span class="token operator">:</span> bcrypt<span class="token punctuation">.</span><span class="token method function property-access">hashSync</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token property-access">password</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">user</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token property-access">roles</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token maybe-class-name">Role</span><span class="token punctuation">.</span><span class="token method function property-access">findAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          where<span class="token operator">:</span> <span class="token punctuation">{</span>
            name<span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token punctuation">[</span><span class="token maybe-class-name">Op</span><span class="token punctuation">.</span><span class="token property-access">or</span><span class="token punctuation">]</span><span class="token operator">:</span> req<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token property-access">roles</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">roles</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
          user<span class="token punctuation">.</span><span class="token method function property-access">setRoles</span><span class="token punctuation">(</span>roles<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
            res<span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> message<span class="token operator">:</span> <span class="token string">"User was registered successfully!"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// user role = 1</span>
        user<span class="token punctuation">.</span><span class="token method function property-access">setRoles</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
          res<span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> message<span class="token operator">:</span> <span class="token string">"User was registered successfully!"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token method function property-access">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
      res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> message<span class="token operator">:</span> err<span class="token punctuation">.</span><span class="token property-access">message</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

exports<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">signin</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token maybe-class-name">User</span><span class="token punctuation">.</span><span class="token method function property-access">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    where<span class="token operator">:</span> <span class="token punctuation">{</span>
      username<span class="token operator">:</span> req<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token property-access">username</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">user</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> message<span class="token operator">:</span> <span class="token string">"User Not found."</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">var</span> passwordIsValid <span class="token operator">=</span> bcrypt<span class="token punctuation">.</span><span class="token method function property-access">compareSync</span><span class="token punctuation">(</span>
        req<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token property-access">password</span><span class="token punctuation">,</span>
        user<span class="token punctuation">.</span><span class="token property-access">password</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>passwordIsValid<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">401</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          accessToken<span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span>
          message<span class="token operator">:</span> <span class="token string">"Invalid Password!"</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">const</span> token <span class="token operator">=</span> jwt<span class="token punctuation">.</span><span class="token method function property-access">sign</span><span class="token punctuation">(</span><span class="token punctuation">{</span> id<span class="token operator">:</span> user<span class="token punctuation">.</span><span class="token property-access">id</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
                              config<span class="token punctuation">.</span><span class="token property-access">secret</span><span class="token punctuation">,</span>
                              <span class="token punctuation">{</span>
                                algorithm<span class="token operator">:</span> <span class="token string">'HS256'</span><span class="token punctuation">,</span>
                                allowInsecureKeySizes<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                                expiresIn<span class="token operator">:</span> <span class="token number">86400</span><span class="token punctuation">,</span> <span class="token comment">// 24 hours</span>
                              <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">var</span> authorities <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      user<span class="token punctuation">.</span><span class="token method function property-access">getRoles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">roles</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> roles<span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          authorities<span class="token punctuation">.</span><span class="token method function property-access">push</span><span class="token punctuation">(</span><span class="token string">"ROLE_"</span> <span class="token operator">+</span> roles<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">.</span><span class="token method function property-access">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          id<span class="token operator">:</span> user<span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">,</span>
          username<span class="token operator">:</span> user<span class="token punctuation">.</span><span class="token property-access">username</span><span class="token punctuation">,</span>
          email<span class="token operator">:</span> user<span class="token punctuation">.</span><span class="token property-access">email</span><span class="token punctuation">,</span>
          roles<span class="token operator">:</span> authorities<span class="token punctuation">,</span>
          accessToken<span class="token operator">:</span> token
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token method function property-access">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
      res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> message<span class="token operator">:</span> err<span class="token punctuation">.</span><span class="token property-access">message</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<h3><span id="Controller_for_testing_Authorization">Controller for testing Authorization</span></h3>
<p>There are 4 functions:<br>
– <code>/api/test/all</code> for public access<br>
– <code>/api/test/user</code> for loggedin users (role: <strong>user</strong>/<strong>moderator</strong>/<strong>admin</strong>)<br>
– <code>/api/test/mod</code> for users having <strong>moderator</strong> role<br>
– <code>/api/test/admin</code> for users having <strong>admin</strong> role</p>
<p><strong>controllers</strong>/<em>user.controller.js</em></p>
<pre class=" language-js"><code class=" language-js">exports<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">allAccess</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token string">"Public Content."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

exports<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">userBoard</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token string">"User Content."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

exports<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">adminBoard</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token string">"Admin Content."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

exports<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">moderatorBoard</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token string">"Moderator Content."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>Now, do you have any question? Would you like to know how we can combine middlewares with controller functions?<br>
Let's do it in the next section.</p>
<h2><span id="Define_Routes">Define Routes</span></h2>
<p>When a client sends request for an endpoint using HTTP request (GET, POST, PUT, DELETE), we need to determine how the server will response by setting up the routes.</p>
<p>We can separate our routes into 2 part: for Authentication and for Authorization (accessing protected resources).</p>
<p><strong>Authentication:</strong></p>
<ul>
<li>POST <code>/api/auth/signup</code></li>
<li>POST <code>/api/auth/signin</code></li>
</ul>
<p><strong>routes</strong>/<em>auth.routes.js</em></p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> <span class="token punctuation">{</span> verifySignUp <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"../middleware"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> controller <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"../controllers/auth.controller"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">app</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token method function property-access">header</span><span class="token punctuation">(</span>
      <span class="token string">"Access-Control-Allow-Headers"</span><span class="token punctuation">,</span>
      <span class="token string">"x-access-token, Origin, Content-Type, Accept"</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  app<span class="token punctuation">.</span><span class="token method function property-access">post</span><span class="token punctuation">(</span>
    <span class="token string">"/api/auth/signup"</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>
      verifySignUp<span class="token punctuation">.</span><span class="token property-access">checkDuplicateUsernameOrEmail</span><span class="token punctuation">,</span>
      verifySignUp<span class="token punctuation">.</span><span class="token property-access">checkRolesExisted</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    controller<span class="token punctuation">.</span><span class="token property-access">signup</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  app<span class="token punctuation">.</span><span class="token method function property-access">post</span><span class="token punctuation">(</span><span class="token string">"/api/auth/signin"</span><span class="token punctuation">,</span> controller<span class="token punctuation">.</span><span class="token property-access">signin</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p><strong>Authorization:</strong></p>
<ul>
<li>GET <code>/api/test/all</code></li>
<li>GET <code>/api/test/user</code> for loggedin users (user/moderator/admin)</li>
<li>GET <code>/api/test/mod</code> for moderator</li>
<li>GET <code>/api/test/admin</code> for admin</li>
</ul>
<p><strong>routes</strong>/<em>user.routes.js</em></p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> <span class="token punctuation">{</span> authJwt <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"../middleware"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> controller <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"../controllers/user.controller"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">app</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token method function property-access">header</span><span class="token punctuation">(</span>
      <span class="token string">"Access-Control-Allow-Headers"</span><span class="token punctuation">,</span>
      <span class="token string">"x-access-token, Origin, Content-Type, Accept"</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">"/api/test/all"</span><span class="token punctuation">,</span> controller<span class="token punctuation">.</span><span class="token property-access">allAccess</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span>
    <span class="token string">"/api/test/user"</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>authJwt<span class="token punctuation">.</span><span class="token property-access">verifyToken</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    controller<span class="token punctuation">.</span><span class="token property-access">userBoard</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span>
    <span class="token string">"/api/test/mod"</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>authJwt<span class="token punctuation">.</span><span class="token property-access">verifyToken</span><span class="token punctuation">,</span> authJwt<span class="token punctuation">.</span><span class="token property-access">isModerator</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    controller<span class="token punctuation">.</span><span class="token property-access">moderatorBoard</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span>
    <span class="token string">"/api/test/admin"</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>authJwt<span class="token punctuation">.</span><span class="token property-access">verifyToken</span><span class="token punctuation">,</span> authJwt<span class="token punctuation">.</span><span class="token property-access">isAdmin</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    controller<span class="token punctuation">.</span><span class="token property-access">adminBoard</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>Don't forget to add these routes in <em>server.js</em>:</p>
<pre class=" language-js"><code class=" language-js"><span class="token spread operator">...</span>
<span class="token comment">// routes</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./app/routes/auth.routes'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./app/routes/user.routes'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// set port, listen for requests</span>
<span class="token spread operator">...</span>
</code></pre>
<h2><span id="Run_Test_with_Results">Run &amp; Test with Results</span></h2>
<p>Run Node.js application with command: <code>node server.js</code></p>
<p>Tables that we define in <em>models</em> package will be automatically generated in MySQL Database.<br>
If you check the database, you can see things like this:</p>
<pre class=" language-sql"><code class=" language-sql">mysql<span class="token operator">&gt;</span> <span class="token keyword">describe</span> users<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">-----------+--------------+------+-----+---------+----------------+</span>
<span class="token operator">|</span> Field     <span class="token operator">|</span> <span class="token keyword">Type</span>         <span class="token operator">|</span> <span class="token boolean">Null</span> <span class="token operator">|</span> <span class="token keyword">Key</span> <span class="token operator">|</span> <span class="token keyword">Default</span> <span class="token operator">|</span> Extra          <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------+--------------+------+-----+---------+----------------+</span>
<span class="token operator">|</span> id        <span class="token operator">|</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>      <span class="token operator">|</span> <span class="token keyword">NO</span>   <span class="token operator">|</span> PRI <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span> <span class="token keyword">auto_increment</span> <span class="token operator">|</span>
<span class="token operator">|</span> username  <span class="token operator">|</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">|</span> YES  <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>                <span class="token operator">|</span>
<span class="token operator">|</span> email     <span class="token operator">|</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">|</span> YES  <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>                <span class="token operator">|</span>
<span class="token operator">|</span> password  <span class="token operator">|</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">|</span> YES  <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>                <span class="token operator">|</span>
<span class="token operator">|</span> createdAt <span class="token operator">|</span> <span class="token keyword">datetime</span>     <span class="token operator">|</span> <span class="token keyword">NO</span>   <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>                <span class="token operator">|</span>
<span class="token operator">|</span> updatedAt <span class="token operator">|</span> <span class="token keyword">datetime</span>     <span class="token operator">|</span> <span class="token keyword">NO</span>   <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>                <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------+--------------+------+-----+---------+----------------+</span>


mysql<span class="token operator">&gt;</span> <span class="token keyword">describe</span> roles<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">-----------+--------------+------+-----+---------+-------+</span>
<span class="token operator">|</span> Field     <span class="token operator">|</span> <span class="token keyword">Type</span>         <span class="token operator">|</span> <span class="token boolean">Null</span> <span class="token operator">|</span> <span class="token keyword">Key</span> <span class="token operator">|</span> <span class="token keyword">Default</span> <span class="token operator">|</span> Extra <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------+--------------+------+-----+---------+-------+</span>
<span class="token operator">|</span> id        <span class="token operator">|</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>      <span class="token operator">|</span> <span class="token keyword">NO</span>   <span class="token operator">|</span> PRI <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">|</span> name      <span class="token operator">|</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">|</span> YES  <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">|</span> createdAt <span class="token operator">|</span> <span class="token keyword">datetime</span>     <span class="token operator">|</span> <span class="token keyword">NO</span>   <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">|</span> updatedAt <span class="token operator">|</span> <span class="token keyword">datetime</span>     <span class="token operator">|</span> <span class="token keyword">NO</span>   <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------+--------------+------+-----+---------+-------+</span>


mysql<span class="token operator">&gt;</span> <span class="token keyword">describe</span> user_roles<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">-----------+----------+------+-----+---------+-------+</span>
<span class="token operator">|</span> Field     <span class="token operator">|</span> <span class="token keyword">Type</span>     <span class="token operator">|</span> <span class="token boolean">Null</span> <span class="token operator">|</span> <span class="token keyword">Key</span> <span class="token operator">|</span> <span class="token keyword">Default</span> <span class="token operator">|</span> Extra <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------+----------+------+-----+---------+-------+</span>
<span class="token operator">|</span> createdAt <span class="token operator">|</span> <span class="token keyword">datetime</span> <span class="token operator">|</span> <span class="token keyword">NO</span>   <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">|</span> updatedAt <span class="token operator">|</span> <span class="token keyword">datetime</span> <span class="token operator">|</span> <span class="token keyword">NO</span>   <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">|</span> roleId    <span class="token operator">|</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>  <span class="token operator">|</span> <span class="token keyword">NO</span>   <span class="token operator">|</span> PRI <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">|</span> userId    <span class="token operator">|</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>  <span class="token operator">|</span> <span class="token keyword">NO</span>   <span class="token operator">|</span> PRI <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------+----------+------+-----+---------+-------+</span>
</code></pre>
<p>If you don't use <code>initial()</code> function in Sequelize <code>sync()</code> method. You need to run following SQL script:</p>
<pre class=" language-sql"><code class=" language-sql">mysql<span class="token operator">&gt;</span> <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> roles <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'user'</span><span class="token punctuation">,</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mysql<span class="token operator">&gt;</span> <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> roles <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'moderator'</span><span class="token punctuation">,</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mysql<span class="token operator">&gt;</span> <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> roles <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'admin'</span><span class="token punctuation">,</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>3 records will be created in <code>roles</code> table:</p>
<pre class=" language-sql"><code class=" language-sql">mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> roles<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">----+-----------+---------------------+---------------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> name      <span class="token operator">|</span> createdAt           <span class="token operator">|</span> updatedAt           <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+-----------+---------------------+---------------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">user</span>      <span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">05</span>:<span class="token number">39</span> <span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">05</span>:<span class="token number">39</span> <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">2</span> <span class="token operator">|</span> moderator <span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">05</span>:<span class="token number">39</span> <span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">05</span>:<span class="token number">39</span> <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">3</span> <span class="token operator">|</span> admin     <span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">05</span>:<span class="token number">39</span> <span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">05</span>:<span class="token number">39</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+-----------+---------------------+---------------------+</span>
</code></pre>
<p>Register some users with <code>/signup</code> API:</p>
<ul>
<li><strong>admin</strong> with <code>admin</code> role</li>
<li><strong>mod</strong> with <code>moderator</code> and <code>user</code> roles</li>
<li><strong>zkoder</strong> with <code>user</code> role</li>
</ul>
<p><img decoding="async" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/node-js-jwt-authentication-mysql-signup-new-user.png" data-src="https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-signup-new-user.png" alt="node-js-jwt-authentication-mysql-signup-new-user" width="600" height="450" class="alignnone size-full wp-image-2025 lazyloaded"><noscript><img decoding="async" src="https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-signup-new-user.png" alt="node-js-jwt-authentication-mysql-signup-new-user" width="600" height="450" class="alignnone size-full wp-image-2025 lazyload" srcset="https://www.bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-signup-new-user.png 600w, https://www.bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-signup-new-user-300x225.png 300w" sizes="(max-width: 600px) 100vw, 600px" /></noscript></p>
<p>Our tables after signup could look like this.</p>
<pre class=" language-sql"><code class=" language-sql">mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> users<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">----+----------+--------------------+--------------------------------------------------------------+---------------------+---------------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> username <span class="token operator">|</span> email              <span class="token operator">|</span> password                                                     <span class="token operator">|</span> createdAt           <span class="token operator">|</span> updatedAt           <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+----------+--------------------+--------------------------------------------------------------+---------------------+---------------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> admin    <span class="token operator">|</span> admin<span class="token variable">@bezkoder.com</span> <span class="token operator">|</span> $<span class="token number">2</span>a$<span class="token number">08</span>$w3cYCF<span class="token punctuation">.</span>N0UQZO19z8CQSZ<span class="token punctuation">.</span>whzxFS5vMoi9k51g3TQx9r5tkwrIXO2 <span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">21</span>:<span class="token number">51</span> <span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">21</span>:<span class="token number">51</span> <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">2</span> <span class="token operator">|</span> mod      <span class="token operator">|</span> mod<span class="token variable">@bezkoder.com</span>   <span class="token operator">|</span> $<span class="token number">2</span>a$<span class="token number">08</span>$tTj1l28esAxPSSvl3YqKl<span class="token punctuation">.</span><span class="token operator">/</span>nz35vQF7Y76jGtzcYUhHtGy6d<span class="token punctuation">.</span><span class="token number">1</span><span class="token operator">/</span>ze <span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">22</span>:<span class="token number">01</span> <span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">22</span>:<span class="token number">01</span> <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">3</span> <span class="token operator">|</span> zkoder   <span class="token operator">|</span> <span class="token keyword">user</span><span class="token variable">@bezkoder.com</span>  <span class="token operator">|</span> $<span class="token number">2</span>a$<span class="token number">08</span>$U2F07dLyYZjzTxQbFMCAcOd1k8V1o9f6E4TGVJHpy0V6<span class="token operator">/</span>DC7iS0CS <span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">23</span>:<span class="token number">25</span> <span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">23</span>:<span class="token number">25</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+----------+--------------------+--------------------------------------------------------------+---------------------+---------------------+</span>


mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> user_roles<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------+---------------------+--------+--------+</span>
<span class="token operator">|</span> createdAt           <span class="token operator">|</span> updatedAt           <span class="token operator">|</span> roleId <span class="token operator">|</span> userId <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+---------------------+--------+--------+</span>
<span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">22</span>:<span class="token number">01</span> <span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">22</span>:<span class="token number">01</span> <span class="token operator">|</span>      <span class="token number">1</span> <span class="token operator">|</span>      <span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">23</span>:<span class="token number">25</span> <span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">23</span>:<span class="token number">25</span> <span class="token operator">|</span>      <span class="token number">1</span> <span class="token operator">|</span>      <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">22</span>:<span class="token number">01</span> <span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">22</span>:<span class="token number">01</span> <span class="token operator">|</span>      <span class="token number">2</span> <span class="token operator">|</span>      <span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">21</span>:<span class="token number">51</span> <span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">21</span>:<span class="token number">51</span> <span class="token operator">|</span>      <span class="token number">3</span> <span class="token operator">|</span>      <span class="token number">1</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+---------------------+--------+--------+</span>
</code></pre>
<p><strong>Access public resource:</strong> GET <code>/api/test/all</code></p>
<p><img decoding="async" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/node-js-jwt-authentication-mysql-get-public-content.png" data-src="https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-get-public-content.png" alt="node-js-jwt-authentication-mysql-get-public-content" width="600" height="220" class="alignnone size-full wp-image-2026 lazyloaded"><noscript><img decoding="async" src="https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-get-public-content.png" alt="node-js-jwt-authentication-mysql-get-public-content" width="600" height="220" class="alignnone size-full wp-image-2026 lazyload" srcset="https://www.bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-get-public-content.png 600w, https://www.bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-get-public-content-300x110.png 300w" sizes="(max-width: 600px) 100vw, 600px" /></noscript></p>
<p><strong>Access protected resource:</strong> GET <code>/api/test/user</code></p>
<p><img decoding="async" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/node-js-jwt-authentication-mysql-get-user-content-not-loggedin.png" data-src="https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-get-user-content-not-loggedin.png" alt="node-js-jwt-authentication-mysql-get-user-content-not-loggedin" width="608" height="408" class="alignnone size-full wp-image-2027 lazyloaded"><noscript><img decoding="async" src="https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-get-user-content-not-loggedin.png" alt="node-js-jwt-authentication-mysql-get-user-content-not-loggedin" width="608" height="408" class="alignnone size-full wp-image-2027 lazyload" srcset="https://www.bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-get-user-content-not-loggedin.png 608w, https://www.bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-get-user-content-not-loggedin-300x201.png 300w" sizes="(max-width: 608px) 100vw, 608px" /></noscript></p>
<p><strong>Login an account (with wrong password):</strong> POST <code>/api/auth/signin</code></p>
<p><img decoding="async" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/node-js-jwt-authentication-mysql-user-signin-wrong-password.png" data-src="https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-user-signin-wrong-password.png" alt="node-js-jwt-authentication-mysql-user-signin-wrong-password" width="584" height="420" class="alignnone size-full wp-image-2028 lazyloaded"><noscript><img decoding="async" src="https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-user-signin-wrong-password.png" alt="node-js-jwt-authentication-mysql-user-signin-wrong-password" width="584" height="420" class="alignnone size-full wp-image-2028 lazyload" srcset="https://www.bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-user-signin-wrong-password.png 584w, https://www.bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-user-signin-wrong-password-300x216.png 300w" sizes="(max-width: 584px) 100vw, 584px" /></noscript></p>
<p><strong>Login an account:</strong> POST <code>/api/auth/signin</code></p>
<p><img decoding="async" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/node-js-jwt-authentication-mysql-user-signin.png" data-src="https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-user-signin.png" alt="node-js-jwt-authentication-mysql-user-signin" width="590" height="528" class="alignnone size-full wp-image-2029 lazyloaded"><noscript><img decoding="async" src="https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-user-signin.png" alt="node-js-jwt-authentication-mysql-user-signin" width="590" height="528" class="alignnone size-full wp-image-2029 lazyload" srcset="https://www.bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-user-signin.png 590w, https://www.bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-user-signin-300x268.png 300w" sizes="(max-width: 590px) 100vw, 590px" /></noscript></p>
<p><strong>Access protected resources:</strong> GET <code>/api/test/user</code></p>
<p><img decoding="async" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/node-js-jwt-authentication-mysql-get-authorized-content.png" data-src="https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-get-authorized-content.png" alt="node-js-jwt-authentication-mysql-get-authorized-content" width="590" height="1232" class="alignnone size-full wp-image-2031 lazyloaded"><noscript><img decoding="async" src="https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-get-authorized-content.png" alt="node-js-jwt-authentication-mysql-get-authorized-content" width="590" height="1232" class="alignnone size-full wp-image-2031 lazyload" srcset="https://www.bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-get-authorized-content.png 590w, https://www.bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-get-authorized-content-144x300.png 144w, https://www.bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-get-authorized-content-490x1024.png 490w" sizes="(max-width: 590px) 100vw, 590px" /></noscript></p>
<h2><span id="Conclusion">Conclusion</span></h2>
<p>Congratulation!</p>
<p>Today we've learned so many interesting things about Node.js Token Based Authentication with JWT - JSONWebToken in just a Node.js Express Rest Api example.<br>
Despite we wrote a lot of code, I hope you will understand the overall architecture of the application, and apply it in your project at ease.</p>
<p>You should continue to know how to implement Refresh Token:<br>
<a href="https://bezkoder.com/jwt-refresh-token-node-js/">JWT Refresh Token implementation in Node.js example</a></p>
<p>If you need a working front-end for this back-end, you can find Client App in the post:<br>
- <a href="https://www.bezkoder.com/jwt-vue-vuex-authentication/">Vue.js JWT Authentication with Vuex and Vue Router</a><br>
- <a href="https://www.bezkoder.com/angular-jwt-authentication/">Angular 8 JWT Authentication example with Web Api</a><br>
- <a href="https://www.bezkoder.com/angular-10-jwt-auth/">Angular 10 JWT Authentication example with Web Api</a><br>
- <a href="https://www.bezkoder.com/angular-11-jwt-auth/">Angular 11 JWT Authentication example with Web Api</a><br>
- <a href="https://www.bezkoder.com/angular-12-jwt-auth/">Angular 12 JWT Authentication example with Web Api</a><br>
- <a href="https://www.bezkoder.com/angular-13-jwt-auth/">Angular 13 JWT Authentication example with Web Api</a><br>
- <a href="https://www.bezkoder.com/react-jwt-auth/">React JWT Authentication (without Redux) example</a><br>
- <a href="https://www.bezkoder.com/react-hooks-jwt-auth/">React Hooks: JWT Authentication (without Redux) example</a><br>
- <a href="https://www.bezkoder.com/react-redux-jwt-auth/">React Redux: JWT Authentication example</a></p>
<p>Happy learning! See you again.</p>
<h2><span id="Further_Reading">Further Reading</span></h2>
<ul>
<li><a href="https://www.npmjs.com/package/express">https://www.npmjs.com/package/express</a></li>
<li><a href="http://expressjs.com/en/guide/routing.html">http://expressjs.com/en/guide/routing.html</a></li>
<li><a href="https://www.bezkoder.com/jwt-json-web-token/">In-depth Introduction to JWT-JSON Web Token</a></li>
<li><a href="https://sequelize.org/master/manual/associations.html">Sequelize Associations</a></li>
</ul>
<p>Fullstack CRUD Application:<br>
- <a href="https://www.bezkoder.com/vue-js-node-js-express-mysql-crud-example/">Vue.js + Node.js + Express + MySQL example</a><br>
- <a href="https://www.bezkoder.com/angular-node-express-mysql/">Angular 8 + Node.js Express + MySQL example</a><br>
- <a href="https://www.bezkoder.com/angular-10-node-js-express-mysql/">Angular 10 + Node.js Express + MySQL example</a><br>
- <a href="https://www.bezkoder.com/angular-11-node-js-express-mysql/">Angular 11 + Node.js Express + MySQL example</a><br>
- <a href="https://www.bezkoder.com/angular-12-node-js-express-mysql/">Angular 12 + Node.js Express + MySQL example</a><br>
- <a href="https://www.bezkoder.com/angular-13-node-js-express-mysql/">Angular 13 + Node.js Express + MySQL example</a><br>
- <a href="https://www.bezkoder.com/angular-14-node-js-express-mysql/">Angular 14 + Node.js Express + MySQL example</a><br>
- <a href="https://www.bezkoder.com/angular-15-node-js-express-mysql/">Angular 15 + Node.js Express + MySQL example</a><br>
- <a href="https://www.bezkoder.com/angular-16-node-js-express-mysql/">Angular 16 + Node.js Express + MySQL example</a><br>
- <a href="https://www.bezkoder.com/react-node-express-mysql/">React + Node.js + Express + MySQL example</a></p>
<p>Deployment:<br>
- <a href="https://bezkoder.com/deploy-node-js-app-heroku-cleardb-mysql/">Deploying/Hosting Node.js app on Heroku with MySQL database</a><br>
- <a href="https://www.bezkoder.com/docker-compose-nodejs-mysql/">Dockerize Node.js Express and MySQL example – Docker Compose</a></p>
<h2><span id="Source_Code">Source Code</span></h2>
<p>You can find the complete source code for this tutorial on <a href="https://github.com/bezkoder/node-js-jwt-auth">Github</a>.</p>
<p>If you want to use Httponly Cookies, please visit:<br>
<a href="https://www.bezkoder.com/node-js-express-login-example/">Node.js Express: Login and Registration example with JWT</a>

</p><div class="quads-location quads-ad3" id="quads-ad3" style="float: none; margin: 30px 0px; text-align: center; visibility: visible;">
<div class="aicp">
<script async="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/f.txt" type="text/javascript"></script>
<ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-9222145312954144" data-ad-slot="4842295194"></ins>
<script type="text/javascript">
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
</div>


</div>

<script async="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/f.txt" type="text/javascript"></script>
<ins class="adsbygoogle" style="display:block" data-ad-format="autorelaxed" data-ad-client="ca-pub-9222145312954144" data-ad-slot="2534441724"></ins>
<script type="text/javascript">
				 (adsbygoogle = window.adsbygoogle || []).push({});
			</script>
<footer class="entry-meta">

<div class="tagcloud">
<a href="https://www.bezkoder.com/tag/authentication/">authentication</a> <a href="https://www.bezkoder.com/tag/authorization/">authorization</a> <a href="https://www.bezkoder.com/tag/express/">express</a> <a href="https://www.bezkoder.com/tag/jwt/">jwt</a> <a href="https://www.bezkoder.com/tag/login/">login</a> <a href="https://www.bezkoder.com/tag/mysql/">mysql</a> <a href="https://www.bezkoder.com/tag/node-js/">node.js</a> <a href="https://www.bezkoder.com/tag/registration/">registration</a> <a href="https://www.bezkoder.com/tag/rest-api/">rest api</a> <a href="https://www.bezkoder.com/tag/security/">security</a> <a href="https://www.bezkoder.com/tag/sequelize/">sequelize</a> <a href="https://www.bezkoder.com/tag/token-based-authentication/">token based authentication</a>
</div>

</footer>
</div>
</article>

<nav class="navigation post-navigation" aria-label="Posts">
<h2 class="screen-reader-text">Post navigation</h2>
<div class="nav-links"><div class="nav-previous"><a href="https://www.bezkoder.com/vue-firebase-realtime-database/" rel="prev"><i class="fa fa-chevron-left"></i> <span class="post-title">Vue Firebase Realtime Database: CRUD example</span></a></div><div class="nav-next"><a href="https://www.bezkoder.com/vue-firestore-crud/" rel="next"><span class="post-title">Vue Firestore: Build a CRUD App example <i class="fa fa-chevron-right"></i></span></a></div></div>
</nav>
</main>
</div>
</div>
<div id="secondary" class="widget-area col-sm-12 col-md-4" role="complementary">
<div class="well">
<aside id="search-4" class="widget widget_search">
<form role="search" method="get" class="form-search" action="https://www.bezkoder.com/">
<div class="input-group">
<label class="screen-reader-text" for="s">Search for:</label>
<input type="text" class="form-control search-query" placeholder="Search…" value="" name="s" title="Search for:">
<span class="input-group-btn">
<button type="submit" class="btn btn-default" name="submit" id="searchsubmit" value="Search"><span class="glyphicon glyphicon-search"></span></button>
</span>
</div>
</form>
</aside><aside id="custom_html-13" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><div class="aicp">
<script async="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/f(1).txt" crossorigin="anonymous" type="text/javascript"></script>

<ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9222145312954144" data-ad-slot="9463360895" data-ad-format="auto" data-full-width-responsive="true"></ins>
<script type="text/javascript">
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div></div></aside><aside style="position: static; margin-bottom: 0px; transition: all 0s ease 0s; transform: none; margin-top: 0px; padding: 0px; width: 300px; top: auto; display: block; height: 0px;"></aside><aside id="custom_html-4" class="widget_text widget widget_custom_html FixedWidget__fixed_widget FixedWidget__fixed_widget__pinned" style="position: fixed; margin-bottom: 0px; transition: all 0s ease 0s; transform: none; margin-top: 0px; padding: 0px; width: 300px; top: 10px; height: 0px;"><div class="textwidget custom-html-widget"><div class="aicp" id="bottom-fixed-widget">
<script async="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/f(1).txt" crossorigin="anonymous" type="text/javascript"></script>

<ins class="adsbygoogle" style="display:inline-block;width:300px;height:600px" data-ad-client="ca-pub-9222145312954144" data-ad-slot="2128162633"></ins>
<script type="text/javascript">
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div></div></aside> </div>
</div>
</div>
</div>
</div>
<div id="footer-area" style="margin-top: 50px;" class="FixedWidget__stop_widget">
<div class="container footer-inner">
<div class="row">
<div class="footer-widget-area">
<div class="col-sm-4 footer-widget" role="complementary">
<div id="custom_html-14" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><a href="https://www.buymeacoffee.com/bezkoder" rel="nofollow noopener" target="_blank"><img src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/donation.png" alt="Buy me a coffee" style="width:160px;height:40px;"></a></div></div> </div>
<div class="col-sm-4 footer-widget" role="complementary">
<div id="sparkling-social-3" class="widget sparkling-social"><h3 class="widgettitle">Follow us</h3>

<div class="social-icons sticky-sidebar-social">
<nav id="menu-social" class="social-icons"><ul id="menu-social-items" class="social-menu"><li id="menu-item-32" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-32"><a href="https://facebook.com/bezkoder"><i class="social_icon"><span>Facebook</span></i></a></li>
<li id="menu-item-37" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-37"><a href="https://www.youtube.com/channel/UCp0mx9RH0JxaFsmMvKXA86Q"><i class="social_icon"><span>Youtube</span></i></a></li>
<li id="menu-item-1212" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1212"><a href="https://github.com/bezkoder"><i class="social_icon"><span>Github</span></i></a></li>
</ul></nav>
</div>
</div> </div>
<div class="col-sm-4 footer-widget" role="complementary">
<div id="nav_menu-2" class="widget widget_nav_menu"><h3 class="widgettitle">Tools</h3><div class="menu-tools-container"><ul id="menu-tools" class="menu"><li id="menu-item-2008" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2008"><a href="https://www.bezkoder.com/json-formatter/">Json Formatter</a></li>
</ul></div></div> </div>
</div>
</div>
</div>
<footer id="colophon" class="site-footer" role="contentinfo">
<div class="site-info container">
<div class="row">
<nav role="navigation" class="col-md-6">
<ul id="menu-footer-links" class="nav footer-nav clearfix"><li id="menu-item-12764" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12764"><a>.</a></li>
<li id="menu-item-130" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-privacy-policy menu-item-130"><a rel="privacy-policy" href="https://www.bezkoder.com/privacy-policy/">Privacy Policy</a></li>
<li id="menu-item-142" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-142"><a href="https://www.bezkoder.com/contact-us/">Contact</a></li>
<li id="menu-item-141" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-141"><a href="https://www.bezkoder.com/about/">About</a></li>
</ul> </nav>
<div class="copyright col-md-6">
<a href="https://www.dmca.com/Protection/Status.aspx?ID=3f543dd5-c6d8-4208-9a6b-0e92057fd597&amp;refurl=https://www.bezkoder.com/node-js-jwt-authentication-mysql/" title="DMCA.com Protection Status" class="dmca-badge"> <img width="150" heigh="30" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/dmca-badge-w150-5x1-08.png" alt="DMCA.com Protection Status"></a>
© 2019-2022 bezkoder.com 
</div>
</div>
</div>
<div class="scroll-to-top" style="display: block;"><i class="fa fa-angle-up"></i></div>
</footer>
</div>
</div>
<div class="my-side-ad">

<script async="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/f(1).txt" crossorigin="anonymous" type="text/javascript"></script>

<ins class="adsbygoogle" style="display:inline-block;width:120px;height:600px" data-ad-client="ca-pub-9222145312954144" data-ad-slot="2454970851"></ins>
<script type="text/javascript">
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<style type="text/css">
    
        #wpfront-notification-bar
        {
        background: #ffffff;
        background: -moz-linear-gradient(top, #ffffff 0%, #ffffff 100%);
        background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#ffffff), color-stop(100%,#ffffff));
        background: -webkit-linear-gradient(top, #ffffff 0%,#ffffff 100%);
        background: -o-linear-gradient(top, #ffffff 0%,#ffffff 100%);
        background: -ms-linear-gradient(top, #ffffff 0%,#ffffff 100%);
        background: linear-gradient(to bottom, #ffffff 0%, #ffffff 100%);
        filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#ffffff', endColorstr='#ffffff',GradientType=0 );
        }
                #wpfront-notification-bar div.wpfront-message
        {
        color: #ffffff;
        }

                #wpfront-notification-bar a.wpfront-button
        {
        background: #00b7ea;
        background: -moz-linear-gradient(top, #00b7ea 0%, #009ec3 100%);
        background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#00b7ea), color-stop(100%,#009ec3));
        background: -webkit-linear-gradient(top, #00b7ea 0%,#009ec3 100%);
        background: -o-linear-gradient(top, #00b7ea 0%,#009ec3 100%);
        background: -ms-linear-gradient(top, #00b7ea 0%,#009ec3 100%);
        background: linear-gradient(to bottom, #00b7ea 0%, #009ec3 100%);
        filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#00b7ea', endColorstr='#009ec3',GradientType=0 );

        color: #ffffff;
        }
                #wpfront-notification-bar-open-button
        {
        background-color: #00b7ea;
                }
                    #wpfront-notification-bar-open-button.top 
            {
            background-image: url(https://www.bezkoder.com/wp-content/plugins/wpfront-notification-bar/images/arrow_down.png);
            }

            #wpfront-notification-bar-open-button.bottom 
            {
            background-image: url(https://www.bezkoder.com/wp-content/plugins/wpfront-notification-bar/images/arrow_up.png);
            }
                    #wpfront-notification-bar  div.wpfront-close
        {
        border: 1px solid #555555;
        background-color: #555555;
        color: #000000;
        }
                #wpfront-notification-bar  div.wpfront-close:hover
        {
        border: 1px solid #aaaaaa;
        background-color: #aaaaaa;
        }
        @media screen and (max-device-width: 728px) { #wpfront-notification-bar-spacer  { display:none; } }@media screen and (max-width: 728px) { #wpfront-notification-bar-spacer  { display:none; } }    </style>


<script type="text/javascript" id="toc-front-js-extra">
/* <![CDATA[ */
var tocplus = {"visibility_show":"show","visibility_hide":"hide","width":"Auto"};
/* ]]> */
</script>
<script type="text/javascript" id="q2w3_fixed_widget-js-extra">
/* <![CDATA[ */
var q2w3_sidebar_options = [{"sidebar":"sidebar-1","use_sticky_position":true,"margin_top":10,"margin_bottom":530,"stop_elements_selectors":"footer-area","screen_max_width":900,"screen_max_height":0,"widgets":["#custom_html-4"]}];
/* ]]> */
</script>
<script defer="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/siteground-optimizer-combined-js-04c3e5f224eab0b03c1c38be6f4d436a.js.download" type="text/javascript"></script>

<iframe name="googlefcPresent" style="width: 0px; height: 0px; border: none; z-index: -1000; left: -1000px; top: -1000px; display: none;" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/saved_resource.html"></iframe><div id="wpfront-notification-bar-spacer" class="" style="height: 0px;">
<div id="wpfront-notification-bar-open-button" aria-label="reopen" class="hidden bottom wpfront-top-shadow" style="position: fixed;"></div>
<div id="wpfront-notification-bar" class="wpfront-fixed   bottom " style="height: 0px; position: fixed; visibility: visible;">
<div aria-label="close" class="wpfront-close">X</div>
<table border="0" cellspacing="0" cellpadding="0" role="presentation" style="height: 100%;">
<tbody style="height: 100%;"><tr style="height: 100%;">
<td>
<div class="wpfront-message">
<script async="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/f.txt" type="text/javascript"></script>

<ins class="adsbygoogle" style="display:inline-block;width:728px;height:90px" data-ad-client="ca-pub-9222145312954144" data-ad-slot="7632902616"></ins>
<script type="text/javascript">
     (adsbygoogle = window.adsbygoogle || []).push({});
</script> </div>
<div>
</div>
</td>
</tr>
</tbody></table>
</div>
</div><iframe name="__tcfapiLocator" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/saved_resource(1).html" style="display: none; width: 0px; height: 0px; border: none; z-index: -1000; left: -1000px; top: -1000px;"></iframe><iframe name="__uspapiLocator" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/saved_resource(2).html" style="display: none; width: 0px; height: 0px; border: none; z-index: -1000; left: -1000px; top: -1000px;"></iframe><iframe name="__gppLocator" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/saved_resource(3).html" style="display: none; width: 0px; height: 0px; border: none; z-index: -1000; left: -1000px; top: -1000px;"></iframe><iframe name="googlefcInactive" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/saved_resource(4).html" style="display: none; width: 0px; height: 0px; border: none; z-index: -1000; left: -1000px; top: -1000px;"></iframe><iframe name="googlefcLoaded" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/saved_resource(5).html" style="display: none; width: 0px; height: 0px; border: none; z-index: -1000; left: -1000px; top: -1000px;"></iframe><div id="naptha_container0932014_0707"></div></body><grammarly-desktop-integration data-grammarly-shadow-root="true"><template shadowrootmode="open"><style>
      div.grammarly-desktop-integration {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
        -moz-user-select: none;
        -webkit-user-select: none;
        -ms-user-select:none;
        user-select:none;
      }

      div.grammarly-desktop-integration:before {
        content: attr(data-content);
      }
    </style><div aria-label="grammarly-integration" role="group" tabindex="-1" class="grammarly-desktop-integration" data-content="{&quot;mode&quot;:&quot;full&quot;,&quot;isActive&quot;:true,&quot;isUserDisabled&quot;:false}"></div></template></grammarly-desktop-integration></html>